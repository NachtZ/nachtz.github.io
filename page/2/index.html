<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="dns-prefetch" href="http://nachtz.top">
  <title>一元硬币</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="北邮本科信安，硕士软件。">
<meta property="og:type" content="website">
<meta property="og:title" content="一元硬币">
<meta property="og:url" content="http://nachtz.top/page/2/index.html">
<meta property="og:site_name" content="一元硬币">
<meta property="og:description" content="北邮本科信安，硕士软件。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一元硬币">
<meta name="twitter:description" content="北邮本科信安，硕士软件。">
  
    <link rel="alternative" href="/atom.xml" title="一元硬币" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.f6a68c.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

</head>
</html>
<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="https://raw.githubusercontent.com/NachtZ/odl_test/master/11970866.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">NachtZ</a></h1>
		</hgroup>
		
		<p class="header-subtitle">闷声发大财，可以为师矣。</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/tags/Resume/">面经</a></li>
	        
				<li><a href="/tags/DPDK/">DPDK</a></li>
	        
				<li><a href="/tags/Leetcode/">Leetcode</a></li>
	        
				<li><a href="/tags/Golang/">Golang</a></li>
	        
				<li><a href="/tags/SDN/">SDN</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/NachtZ" title="github" rel="external nofollow noopener noreferrer"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="http://weibo.com/nachtz" title="weibo" rel="external nofollow noopener noreferrer"><i class="icon-weibo"></i></a>
		        
					<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/nachtz" title="zhihu" rel="external nofollow noopener noreferrer"><i class="icon-zhihu"></i></a>
		        
					<a class="mail" target="_blank" href="mailto:nachtz@outlook.com" title="mail" rel="external nofollow noopener noreferrer"><i class="icon-mail"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="https://raw.githubusercontent.com/NachtZ/odl_test/master/11970866.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">NachtZ</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>闷声发大财，可以为师矣。<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
				
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/NachtZ" title="github" rel="external nofollow noopener noreferrer"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/nachtz" title="weibo" rel="external nofollow noopener noreferrer"><i class="icon-weibo"></i></a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/nachtz" title="zhihu" rel="external nofollow noopener noreferrer"><i class="icon-zhihu"></i></a>
			        
						<a class="mail" target="_blank" href="mailto:nachtz@outlook.com" title="mail" rel="external nofollow noopener noreferrer"><i class="icon-mail"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 16.666666666666668%"><a href="/">主页</a></li>
		        
					<li style="width: 16.666666666666668%"><a href="/tags/Resume/">面经</a></li>
		        
					<li style="width: 16.666666666666668%"><a href="/tags/DPDK/">DPDK</a></li>
		        
					<li style="width: 16.666666666666668%"><a href="/tags/Leetcode/">Leetcode</a></li>
		        
					<li style="width: 16.666666666666668%"><a href="/tags/Golang/">Golang</a></li>
		        
					<li style="width: 16.666666666666668%"><a href="/tags/SDN/">SDN</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionheight="100" data-contentid="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-SDN_defense4all" class="article article-type-post  article-index" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/SDN_defense4all.html">Defense4All 粗翻</a>
    </h1>
  

        
        <a href="/SDN_defense4all.html" class="archive-article-date">
  	<time datetime="2017-02-23T05:24:31.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-02-23</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言：Defense4All-粗翻"><a href="#前言：Defense4All-粗翻" class="headerlink" title="前言：Defense4All 粗翻"></a>前言：Defense4All 粗翻</h2><hr>
<p><strong>对<a href="https://wiki.opendaylight.org/view/Defense4All:Tutorial" rel="external nofollow noopener noreferrer" target="_blank">Defense4All:Tutorial</a>的粗翻，基于Google翻译加上自己修改。旨在为自己毕设提供一种设计思路。</strong>  </p>
<h2 id="Defense4All：教程"><a href="#Defense4All：教程" class="headerlink" title="Defense4All：教程"></a>Defense4All：教程</h2><p>内容<br> [ 隐藏 ]<br>1 简介<br>2 Defense4All设计<br>3 部署替代<br>4 Defense4All在ODL环境中<br>5 框架视图<br>6 应用视图<br>7 ODL代表视图<br>8 基本控制流程<br>9 配置和设置流程<br>10 攻击检测流程<br>11 攻击减轻流程<br>12 问题和故障排除<br>13 连续性<br>14 维护和升级<br>15 新术语和概念<br>16 其他信息<br>16.1 安全和隐私<br>16.2 兼容性<br>16.3 性能和可伸缩性信息<br>16.4 参考资料</p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>将可疑流量从正常网络路径转移到专用攻击缓解设备来进行清洗和威胁检测是一个普遍的DoS攻击环节和威胁检测策略。这些基础架构也被称为安全中心或者清洗中心，主要由第3层到第7层DoS攻击缓解设备组成。这些清洗中心可以以路径外（OOP）方式（不内嵌在本地业务流）部署在网络内的专用远程站点，因此将流量转移到这些中心是必要的。在流量清洗过程期间，攻击缓解基础设施识别并丢弃恶意IP分组，并将合法IP分组转发回其原始目标网络目的地。清洗中心可以位于企业网络，数据中心或云中，也可以作为运营商基础设施的一部分。一般来说，OOP系统中的DDoS防护包括以下主要元素：</p>
<ul>
<li>在正常时期收集被保护网络的流量统计和对流量统计特征的学习。 受保护网络的正常流量基线是由这些收集的统计信息构建的。</li>
<li>认为偏离正常流量基线的流量异常可能是DoS攻击。</li>
<li>将可疑流量从其正常路径转移到缓解（清洗）中心，用于流量清洗，选择性源阻塞等。从清洗中心出来的干净流量被重新发往到原始目的地中。</li>
</ul>
<h2 id="Defense4All设计"><a href="#Defense4All设计" class="headerlink" title="Defense4All设计"></a>Defense4All设计</h2><p>Defense4All是一种SDN安全应用程序，用于检测和缓解在不同SDN拓扑中的DoS和DDoS攻击。它实现了基于可编程流的SDN环境的OOP模式下的DoS防护。管理员可以配置Defense4All以保护某些网络和服务器，程序中将之称为受保护网络或受保护对象（POs​​）。Defense4All利用SDN功能来统计指定的流量，并在每个网络位置，为每个配置中的PO，安装针对不同协议的计数流。然后Defense4All监控所有配置的PO的流量，汇总来自所有相关网络位置的读取操作，速率和平均值。如果在特定PO的协议（例如TCP，UDP，ICMP或其余流量）中检测到与正常学习的流量行为的偏差，则Defense4All在目标PO中宣布发现基于该种协议的攻击。Defense4All在安装计数流后至少需要一个星期的学习时间，在这期间Defense4All不检测攻击。为了缓解检测到的攻击，Defense4All执行以下过程：</p>
<ol>
<li>它确认DefensePro设备是否处于正常状态，并选择和正常工作的设备进行连接（如果DefensePro没有启动或没有心跳活动连接，则不会执行流量转移）。有关详细信息，请参阅“连续性”部分。</li>
<li>Defense4All使用安全策略和攻击流量的正常速率来配置DefensePro。后者能提升DefensePro对攻击的缓解。</li>
<li>Defense4All开始从DefensePro中监测和记录系统日志。只要它继续从DefensePro接收关于此攻击的攻击通知，Defense4All就会继续转移流量来继续进行攻击缓解，即使Vexternal FlowFilter计数器不提示流量中包含任何攻击。</li>
<li>Defense4All通过创建一对Vexternals并将它们映射到与DefensePro连接的所选物理PFS端口对，将所选的物理DefensePro连接映射到相关的VTN。并且会自动学习和保留VLAN标记（如果存在）。如果Defense4All已经在VTN中创建并映射了具有相同VLAN的一对Vexternals，则相同的对也被重新用于新流量的转移（而不是为相同的VTN和VLAN创建新的Vexternals）。</li>
<li>Defense4All在每个北向Vexternal中安装较高优先级的流过滤条目，通过该过滤条目，将攻击流量转移重定向到“北向DP-In Vexternal”。它还选择连接到所有Vexternals的Vbr的活北接口之一（可以有一个具有相同VLAN的Vbr）。Defense4All将来自“DP-Out Vexternal”的流量重新注入到选定的Vbr接口。（<strong> 这句话看不懂 </strong>）当Defense4All确定攻击已结束（没有来自PFC FlowFilter计数器或来自DefensePro的指示）时，它会恢复先前的流量：它停止监视有关流量的DefensePro syslog，它会删除流量转移流表项，删除“DP-In和DP-Out Vexternals“（如果这是此VTN和VLAN中的最后一次攻击），并从DefensePro中删除安全配置。Defense4All然后返回到正常监控。</li>
</ol>
<p>在此版本中，Defense4All作为单个实例（非集群）运行，但它集成了以下主要容错功能：</p>
<ul>
<li>它作为Linux服务运行，如果失败，它会自动重新启动。</li>
<li>有状态服务，会将最新的运行状态保存在可靠存储中，并能恢复运行。</li>
<li>它带有一个有重启和重置功能的健康跟踪器，以解决某些逻辑和老化的错误。<br>Defense4All监控DefensePro的状态，连接到DefensePro的交换机，在各种VTN中的相关Vbr(虚拟网桥)，这些Vbr的北向接口和北Vexternals。它依此调整，取消和（重新）发起攻击流量转移。下图说明了任何给定PO的可能状态。Radware的DefensePro（DP）是具体化的AMS的示例。 </li>
</ul>
<p><img src="https://wiki.opendaylight.org/view/File:Pn_possible_states.jpg" alt="图1：Defense4All攻击减轻的工作流程"></p>
<p>PN可能状态</p>
<h2 id="部署替代"><a href="#部署替代" class="headerlink" title="部署替代"></a>部署替代</h2><p>Defense4All支持“短转移”，即AMS（攻击减轻系统）连接到边缘路由器，从而实现只用一跳进行流量重定向。另请参见图3中的PE1和DefensePro 2。“长转向”，即AMS清洗中心位于网络中的任意远程位置，将在未来的Defense4All版本中添加。参见下图中的PE2和DefensePro 1。Defense4All支持自动和手动转移模式。手动模式即在转移前需要向用户进行确认。</p>
<p><img src="https://wiki.opendaylight.org/images/e/e5/Redirection_alternatives.jpg" alt="Defense4All部署流量重定向替代"></p>
<h2 id="基于ODL的Defense4All"><a href="#基于ODL的Defense4All" class="headerlink" title="基于ODL的Defense4All"></a>基于ODL的Defense4All</h2><p>Defense4All是一种用于检测和缓解DDoS攻击的SDN应用程序。应用程序通过ODC北向REST API与OpenDaylight控制器通信。通过这个API，Defense4All执行两个主要任务：</p>
<ul>
<li>监控受保护流量的行为 - 应用程序在所选网络位置中设置流条目以读取每个PN的流量统计（从多个位置聚集针对给定PN收集的统计）。</li>
<li><p>将攻击流量转移到选定的AMS - 应用程序在选定的网络位置中设置流条目，以将流量转移到所选的AMS。当攻击完成时，应用程序将删除这些流条目，从而返回到正常操作和流量监控。<br>Defense4All可以与设定好的AMS通信 - 例如，动态配置它们，监视它们，或者收集和操作来自AMS的攻击统计。AMS的API不是标准化的，在任何情况下都超出了OpenDaylight工作设计的范围。Defense4All包含一个参考实现可插拔驱动程序，与Radware的DefensePro AMS通信。应用程序提供其北向REST和CLI API，以允许其管理器：</p>
</li>
<li><p>控制和配置应用程序（运行时参数，ODC连接，域中的AMS，PN等等）。</p>
</li>
<li><p>从Defense4All和其他来源（如ODC，AMS）统一获取报告数据 - 操作或安全，当前或历史。<br><img src="https://wiki.opendaylight.org/images/thumb/5/5b/D4A_in_odl.jpg/900px-D4A_in_odl.jpg" alt="Defense4在OpenDaylight环境中的所有逻辑定位"><br>Defense4All包括一个SDN应用程序框架和Defense4All应用程序本身，打包为一个单一的实体。应用程序集成到框架中是可插入的，因此任何其他SDN应用程序都可以受益于公共框架服务。这种架构的主要优点是：</p>
</li>
<li><p>更快的应用程序开发和更改 - 框架包含用于多个应用程序的公共代码，复杂元素（例如集群和存储库服务）只需要实现一次就能复用。</p>
</li>
<li>更快，更灵活地部署在不同的环境，形式因素，满足不同的NFR - 框架掩盖SDN应用因素，如所需的数据生存性，规模和弹性，可用性，安全性。</li>
<li>更强的鲁棒性 - 复杂的框架代码实现和测试一次，更清晰的关注分离导致更稳定的代码，框架可以主动增加鲁棒性，没有额外的代码在应用程序逻辑（如周期性应用程序循环）。</li>
<li>统一管理的共同方面 - 共同的外观和感觉。<br>框架视图<br><img src="https://wiki.opendaylight.org/images/thumb/b/bb/Framework_view.jpg/1350px-Framework_view.jpg" alt="从框架的角度看Defense4All结构"><br>框架包含以下元素：</li>
</ul>
<p><strong>FrameworkMain</strong> - 框架根点包含对所有框架模块和全局存储库的引用，以及部署的SDN应用程序的根（在当前版本中，框架只能容纳一个应用程序）。这也是启动，停止或重置框架（连同其管辖的应用程序）的Web服务器，运行Jersey RESTful Web服务框架的Jetty Web服务器，使用Jackson解析器解析JSON编码参数。REST Web服务器为框架运行一个servlet，同时为每个已部署的应用程序（目前只有一个）运行单独一个servlet。所有REST和CLI API都通过此REST Web服务器提供服务。 </p>
<p><strong>FrameworkRestService</strong> - 构成响应框架REST请求（获取最新的Flight Recorder记录，执行恢复出厂设置等）的框架servlet的一组类。FrameworkRestService针对FrameworkMgmtPoint调用控制和配置方法，并且报告它直接从相关存储库检索信息。它调用专门的FlightRecorder的方法来获取Flight Recorder。 </p>
<p><strong>FrameworkMgmtPoint</strong> - 驱动器控制和配置命令（启动，停止，重置，设置主机的地址，等等）的点。FrameworkMgmtPoint反过来按照正确的顺序调用其他相关模块的方法。它将生命周期请求（开始，停止，重置）直接转发到FrameworkMain，以按正确的顺序驱动它们。 </p>
<p><strong>Defense4All应用程序</strong> - 任何SDN应用程序（在本例中为Defense4All）都应该Implement/extendAppRoot对象。SDN应用程序没有“main”，并且它们的生命周期（启动，停止，重置）由对应用程序根对象操作的框架管理，然后应用程序根对象驱动应用程序中的所有生命周期操作。此模块还包含回框架的引用，允许应用程序使用框架服务（例如创建Repo并记录Flight Record）和常见实用程序。 </p>
<p><strong>通用类和实用程序</strong> - 一个方便的类和实用程序库，任何框架或SDN应用程序模块都可以从中受益。示例包括包装线程服务（用于异步，定期或后台执行），字符串的短散列和用户确认。 </p>
<p><strong>存储库服务</strong> - 框架理念中的关键元素之一是将计算状态与计算逻辑分离。所有持久状态都应该存储在一组存储库中，然后可以在不知道计算逻辑（框架或应用程序）的情况下进行复制，缓存，分发。存储库服务包括RepoFactory和Repo或其等价物 - EntityManager。RepoFactory负责与底层存储库插件服务建立连接，实例化新的请求存储库，并返回对现有存储库的引用。所选的底层存储库服务是通过Cassandra NoSQL DB的Hector Client。Repo呈现单个DB表的抽象。它使得能够只用表键就能读取整个表，（表仅由单个主键索引），记录单个单元，以及依照控制要求写入记录。并能够写入子记录（仅具有单元的一部分）。在这种情况下，显示的单元格覆盖存储库中的现有单元格。存储库中的其他单元格保持不变。与关系数据库（其中所有列都必须预先指定（在模式设计中）相反），Repo利用底层Cassandra支持来在相同的表中包含不同列的集合（记录），其中一些列可能甚至没有预先定义。此外，具有新列的单元可以在运行中添加或移除。RepoFactory和Repo（以及它的等价物Entity Manager）构成了一个基于与Cassandra Repository集群通信的Hector客户端库之上，针对框架和SDN应用程序目标的方便的库。Cassandra集群伸缩，跨Cassandra集群成员分发数据，以及配置读/写热切和一致性大部分封装在此层中。 </p>
<p><strong>日志记录和Flight Recorder服务</strong> - 日志记录服务使用Log4J库记录错误，警告，跟踪或提示消息。这些日志主要用为Defense4All开发人员所用。管理员可以从错误日志中获取有关故障的其他详细信息。FlightRecorder记录由Defense4All模块记录的所有航班记录，包括从外部网络元件（如ODC和AMS）接收的信息。然后，它允许用户或管理员通过REST API或CLI获取该信息。航班记录可以按类别（可以指定零个或多个）和时间范围进行过滤。FlightRecorder将所有航班记录存储在其自己的Repo中（其他repo从存储在其他区域的记录库中使用有效时间范围检索获取这些记录）。由于所有航班记录都存储在Cassandra中，Defense4All可以保留的航班记录数量仅受所有Cassandra服务器的底层持久存储容量的限制，因此即使在单个Cassandra实例上，也可以保留几个月的历史信息。 </p>
<p><strong>HealthTracker</strong> - 在Defense4All的运行时进行统一健康状况并响应严重恶化的行为。任何模块在感测到其中或任何其他模块中的意外和/或错误行为时，可以在HealthTracker中记录“健康问题”，并提供健康问题的症状。这不会直接触发Defense4All终止。这意味着在短时间内聚合的许多健康问题可能意味着Defense4All存在问题，但是偶发性和/或间歇性操作性“打嗝”可以被忽略，即使Defense4All保持小于100％可操作管理员可以始终将其重置以完全恢复）。结果，每个非永久性健康问题都随着时间的推移逐渐减弱。如果Defense4Al健康恶化低于预定义阈值，HealthTracker会根据健康问题的性质触发响应操作。重启可以治愈瞬态问题，因此HealthTracker触发Defense4All终止（作为Linux服务运行，Defense4All自动重新启动）。要从更永久的问题中恢复，HealthTracker可能还会触发Defense4All重置。如果这没有帮助，下次HealthTracker尝试更深层次的重置。作为最后手段，可以建议管理员执行出厂重置。 </p>
<p><strong>ClusterMgr</strong> - 当前未实现，<strong>所以不翻译了，保留机翻</strong>。此模块负责管理一个Defense4All集群（与Cassandra或ODC集群分开，建模为单独的层集群）。集群的Defense4All提高了高可用性和可扩展性。Defense4All框架或应用程序中的任何模块都可以向ClusterMgr注册集群操作，指定其功能是由单个还是由多个/所有活动实例（在不同的Defense4All集群成员上运行）执行。当集群成员资格更改时，ClusterMgr会通知每个模块中的每个实例其在该模块的集群操作中的角色。如果存在单个活动实例，则会通知该实例在集群中的角色，而所有其他实例都会通知它们处于待机模式。如果有多个活动实例，则通知每个活动实例关于该范围中的活动实例数及其逻辑枚举。所有状态都存储在一个全局可访问和共享的存储库中，所以模块的任何实例都是无状态的，并且可以在每个成员更改后执行任何角色。例如，在成员资格变化N之后，实例可以被枚举为7中的2个，作为执行工作的相关部分的结果。在成员变化N + 1，相同的实例可以枚举6中的5，并且执行分配给5而不是2的工作部分。跳过对等消息服务，ClusterMgr可以提供用于更协调的跨实例操作。 </p>
<p>Defense4All应用程序是高度可插拔的。它可以适应不同版本的ODC和不同AMS的不同攻击检测机制，不同攻击缓解驱动程序和驱动程序（称为代表）。Defense4All应用程序包括“核心”模块和实现定义明确的Defense4All应用程序API的“可插拔”模块。</p>
<p>应用程序视图<br><img src="https://wiki.opendaylight.org/images/thumb/3/35/D4a_application_view.jpg/1350px-D4a_application_view.jpg" alt="Defense4All Defense4All应用程序结构"><br>以下是对Defense4All应用程序模块的描述：</p>
<p><strong>DFAppRoot</strong> - Defense4All应用程序的根模块。Defense4All应用程序没有“main”，它的生命周期（启动，停止，重置）由对此模块操作的框架管理，从而驱动Defense4All应用程序中的所有生命周期操作。DFAppRoot还包含对所有Defense4All应用程序模块（核心和可插入），全局存储库和回到框架的引用的引用，从而允许Defense4All应用程序模块使用框架服务（例如创建Repo并记录航班记录）和公用实用程序。</p>
<p><strong>DFRestService</strong> - 构成Defense4All应用程序servlet的一组类，用于响应Defense4All应用程序REST请求。DFRestService针对DFMgmtPoint调用控制和配置方法，并且报告它直接从相关存储库检索信息。对于飞行记录，它调用针对FlightRecorder的方法。</p>
<p><strong>DFMgmtPoint</strong> - 驱动器控制和配置命令（如addams和addpn）的点。DFMgmtPoint反过来按照正确的顺序调用其他相关模块的方法。</p>
<p><strong>ODL Reps</strong> - 用于不同版本的ODC的可插拔模块集。包括两个子模块中的两个功能：相关流量的统计收集和流量转移。这两个子模块遵循StatsCollectionRep DvsnRep API。ODL Reps在图6和其后的描述中详细描述。</p>
<p><strong>SDNStatsCollector</strong> - 负责在指定的网络位置（物理或逻辑）为每个PN设置“计数器”。计数器是ODC可用的网络交换机和路由器中的一组OpenFlow流条目。SDNStatsCollector定期从这些计数器收集统计信息，并将它们馈送到SDNBasedDetectionMgr（请参阅下面的描述）。模块使用SDNStatsCollectionRep设置计数器并从这些计数器读取最新的统计信息。stat报告由读取时间，计数器规范，PN标签和trafficData信息列表组成，其中每个trafficData元素包含在计数器位置中为<code>&lt;protocol，port，direction&gt;</code>配置的流条目的最新字节和分组值。协议可以是<code>{tcp，udp，icmp，other ip}</code>，端口是任何第4层端口，方向可以是<code>{inbound，outbound}</code>。</p>
<p><strong>SDNBasedDetectionMgr</strong> - 用于可插拔基于SDN的检测器的容器。它将从SDNStatsCollector接收的统计信息报告给插入的基于SDN的检测器。它还从关于结束攻击的攻击分辨点（参见下面的描述）馈送所有基于SDN的检测器通知（以允许检测机制的重置）。</p>
<p><strong>RateBasedDetector子模块</strong> - 该检测器针对每个PN了解其随时间的正常流量行为，并在检测到流量异常时通知AttackDecisionPoint（参见下面的描述）。对于每个PN的每个协议{TCP，UDP，ICMP，其他IP}，RateBasedDetector保持字节和分组的最新速率和指数移动平均值（基线）以及最后读取时间。检测器保持每个计数器的这些值以及每个PN的所有计数器的聚合。在两个计算级别（计数器和PN聚合）的组织允许更好的可扩展性（例如使用集群ODC，其中每个实例负责从一部分网络交换机获得统计数据，并绕过ODC单实例映像API）。这样的组织还使得能够进行更精确的统计收集（避免在非常小的时间间隔期间收集所有统计的困难）。统计在计数器级处理，并且在PN级定期聚合。持续检测到流量异时，RateBasedDetector通知AttackDecisionPoint进行攻击检测。然后，在一段时间内没有异常，就通知检测器停止该攻击检测。检测器可以指定检测持续时间，在该检测持续时间内检测有效。之后，检测过期，但可以“延长”另一个关于相同攻击的通知。</p>
<p><strong>AttackDecisionPoint</strong> - 此模块负责在攻击生命周期内应对攻击。它可以从多个检测器接收攻击检测信息。Defense4All支持RateBasedDetector，外部检测器（未来版本可用）和基于AMS的检测器参考实现（基于Radware的DefensePro）。在当前版本中，AttackDecisionPoint完全尊重每次检测（最大检测器置信度和最大检测置信度）。它为每次检测到新攻击的流量（PN，协议和端口）声明一个新的攻击，并且为现有（已声明的）攻击增加更多的检测。模块定期检查所有攻击的状态。只要至少有一个未到期的检测（每个检测都有一个到期时间），就会继续声明攻击。如果对于给定攻击的所有检测都过期，则AttackDecisionPoint声明攻击已经结束。模块通知MitigationMgr（见下面的描述）开始减轻任何新的声明的攻击。它通知MitigationMgr停止缓解已结束的攻击，并通知detectMgr重置对攻击刚刚结束的流量的统计计算。</p>
<p><strong>MitigationMgr</strong> - 用于驱动可插拔攻击缓解程序的容器。MitigationMgr维护所有攻击缓解，并负责通知来自AttackDecisionPoint的攻击缓解请求的结果。它包含预先排好序列的MitigationDriver子模块，并尝试按照该顺序满足每个攻击缓解。如果MitigationDriveri向MitigationMgr指示它不缓解一个攻击缓解（由于每个PN偏好，AMS资源的不可用性，网络问题等），MitigationMgr将尝试通过MitigationDriveri + 1进行缓解。如果没有插入的MitigationDrivers处理缓解，则它仍处于“未缓解”状态。</p>
<p><strong>MitigationDriverLocal</strong> - 此缓解驱动程序负责在其管理范围内使用AMS来驱动攻击缓解。当请求缓解攻击时，此缓和剂执行以下步骤顺序：</p>
<ol>
<li>它向可插入DvsnRep（见下面的描述）咨询关于从每个相关网络位置的每个管理的AMS的拓扑可行的转移选项。在此版本中，转移始终从安装统计计数器的位置执行。</li>
<li>MitigationDriverLocal在所有可行选项中选择一个AMS（在第一个版本中，只选择列表中的第一个）。</li>
<li>在指示将业务转移到每个AMS之前，它随机分配所有AMS（每个转向源可以有与其相关联的不同AMS）。这是通过插入AMSRep完成的。</li>
<li>MitigationDriverLocal指示DvsnRep，将来自每个源NetNode（在此版本中，NetNode为SDN交换机）的流量转移到与该NetNode相关联的AMS。转移可以仅用于入站流量，也可以用于入站和出站流量。</li>
<li>攻击缓解驱动程序通知AMSBasedDetector开始监视所有AMS中的攻击状态，并将攻击检测馈送到AttackDecisionPoint。</li>
<li>在未来版本中，MitigationDriverLocal会监视所有AMS和网络拓扑的相关部分的运行状况，可以重新选择AMS（如果该AMS缓解失败），或者依照网络拓扑变动重新选择AMS。<br>当缓解应该结束时，MitigationDriverLocal通知AMSBasedDetector停止监视已结束攻击的攻击状态，通知DvsnRep停止对所有AMS的流量转移以进行此缓解，最后通知AMSRep可选地清除每个缓冲中的所有缓解相关配置集相关的AMS。</li>
</ol>
<p><strong>AMSBasedDetector</strong> - 此可选模块（可以打包为AMSRep的一部分）负责监视/查询AMS的攻击缓解。注册为检测器，此模块然后可以通知AttackDecisionPoint有关攻击持续和结束。它仅监视指定的AMS，并且仅监视指定（攻击的）流量。</p>
<p><strong>AMSRep</strong> - 用于不同AMS的可插拔模块。该模块遵守AMSRep API。它可以支持所有引入的AMS的配置（永久或在攻击缓解之前/之后）。它还可以接收/查询安全信息（攻击状态），以及操作信息（健康，负载）。AMSRep模块是完全可选的 - AMS可以在外部配置和监控。在许多情况下，攻击可以继续通过SDN计数器单独监控。Defense4All包含与Radware的DefensePro AMS通信的参考实现AMSRep。</p>
<h2 id="ODL代表视图"><a href="#ODL代表视图" class="headerlink" title="ODL代表视图"></a>ODL代表视图</h2><p><img src="https://wiki.opendaylight.org/images/thumb/5/54/D4a_odl_reps_view.jpg/1350px-D4a_odl_reps_view.jpg" alt="Defense4All Defense4All ODL Reps结构"><br>上图描述了Defense4All应用程序ODL Reps模块集结构。不同版本的OFC可以用ODL Reps模块集的不同版本实现。ODLReps包括两个功能：相关流量的统计收集和流量转移。这两个功能或任一功能可以在给定部署中使用。因此，它们在与ODC通信，并保存ODC的所有一般信息（见下文）具有相通之处。</p>
<p>ODL Reps支持两种类型的SDN交换机：sdn-hybrid，支持SDN和传统路由; sdn-native，支持仅SDN路由。在传统路由中，通过对预设流表和动作“send to normal”的流条目进行计数来计算sdn混合交换机上的流量。在sdn-native交换机上计数流量需要一个显式路由操作（将流量发送到哪个输出端口）。Defense4All通过要求一个sdn本地交换机避免学习所有路由表，该交换机或多或少是相对于流量路由的有线路径（即，进入端口1的流量通常退出端口2，进入端口3的流量通常退出端口4反之亦然）。<strong>（Defense4All avoids learning all routing tables by requiring an sdn-native switch which is more or less a bump-in the wire with respect to traffic routing (that is, traffic entering port 1 normally exits port 2 and traffic entering port 3 normally exits port 4 and vice versa).）</strong>这种交换机允许简单地对流条目进行编程，以便计数流量或者将流量转移到附接的AMS /从附接的AMS转移流量。当Defense4All编写具有包括端口1的选择标准的流量计数流条目时，其操作被输出到端口2，并且类似地被输出从3到4.在未来的版本中，该限制被排除。</p>
<p>以下是子模块的描述：</p>
<p><strong>StatsCollectionRep</strong> - 该模块遵守StatsCollectionRep API。其主要任务是：</p>
<ul>
<li>在网络中提供计数器展示位置NetNodes。提供的NetNodes是为PN定义的所有NetNode。这基本上映射了哪些SDN交换给定PN流的业务。</li>
<li>在选定的NetNodes中添加一个平时计数器，以收集给定PN的统计信息。StatsCollectionRep为每个PN中的NetNode创建一个单独的计数器。（总体上，NetNode可以具有用于不同PN的多个计数器;并且PN可以在为给定PN指定的NetNode中具有多个计数器）。StatsCollectionRep将NetNode中的计数器的安装转换为为NetNode端口中的每个“北向接口”编程四个流条目（对于TCP，UDP，ICMP和其余IP），从客户端到受保护的PN进入SDN交换机。例如，StatsCollectionRep对具有三个端口的SDN交换机中的给定PN 12流条目添加，其中PN的入站业务进入OFS。并且，如果指定另一个NetNode（SDN交换机）使该PN的入站流量通过两个端口进入，则StatsCollectionRep在该第二个NetNode中为该PN添加八个流条目。</li>
<li>删除一个平时计数器。</li>
<li>读取指定计数器的最新计数器值。StatsCollectionRep返回在每个方向上（每个方向上当前只支持“从北向南”）为每个协议端口计数的最新字节和分组的向量，以及从ODC接收到读取的时间。</li>
</ul>
<p><strong>DvsnRep</strong> - 该模块遵守DvsnRep API。其主要任务是：</p>
<ul>
<li>将指定NetNode的转移属性返回给定的AMS。在这个版本中，如果这样的转移是拓扑可行的（AMS直接附加到指定的NetNode被建模的SDN交换机上，则返回空属性，否则不返回任何属性，这在将来的版本中留有用于远程转移的空间，每个远程AMS的拓扑成本，例如延迟，带宽预留和成本）。</li>
<li>通过AMS转发（攻击）来自指定NetNode的流量。因此，新的流条目优先于和平时段的流条目。DvsnRep编程流条目，以将每个“北向接口”的入站攻击流量（如果PN需要的话，也可以为所有流量）转移到AMS“北”端口。如果已经为该PN指定了“对称转移”（对于入站和返回，出站业务），DvsnRep编程另一组流条目以将来自每个“南业务端口”的受攻击（或所有）流量转移到AMS“南”港口。在sdn混合交换机部署中，DvsnRep为从AMS南端口返回的入站流量添加流条目，并将操作发送到正常，并且类似地，它为来自AMS北端口的出站返回流量添加流条目，也送正常。在SDN本地交换机中，操作是发送到正确的输出端口，但是如果这种情况下，过程对于确定正确的端口更复杂。北端口MAC学习用于从分组中的源/目的MAC确定正确的输出端口。这种流条目的方案适用于TCP，UDP和ICMP攻击。对于“其他IP”攻击，流条目编程更复杂，这里为了清楚起见而被抑制。被编程为转移（但仍然计数）业务的流条目的集合包括“攻击业务量楼层”。可能有许多攻击流量楼层，所有这些都优先于和平时间统计收集楼层（通过编程较高优先级流条目）。额外的攻击（除了“其他IP”攻击，这是一种特殊情况，在此被抑制）创建具有高于先前设置的攻击流量楼层的优先级流量楼层。攻击可以完全或部分地“早期”攻击（例如，通过TCP的TCP端口80，反之亦然），或者不连接（例如TCP和UDP）。统计收集来自所有交通楼层，包括平时和攻击。基于SDN的检测器将所有统计数据聚合为总速率，从而确定攻击是否仍在进行中。（请注意，黯淡的和平时间计算的交通可能显示零利率，并且计数由较高优先权楼层计数器补充）。<strong>在细看</strong></li>
<li>结束转移。DvsnRep删除相关的攻击流量层（即从NetNode中删除其所有流条目）。注意，这既不影响已移除楼层“上方”的流量层，也不影响“下面的流量层”。此外，基于SDN的检测器从剩余楼层的计数器接收相同的累计费率，因此其操作也不受影响。</li>
</ul>
<p><strong>ODLCommon</strong> - 此模块包含编程ODC中流条目所需的所有常见元素。这允许通过StatsCollectionRep和DvsnRep对配置的ODC（在该版本中，至多一个）进行相干编程。例如ODLCommon实例化与ODC的连接，维护分配给每个ODC的编程流条目和cookie的列表。它还维护对DFAppRoot和FrameworkMain的引用。为每个受保护链路添加sdn本地NetNode时ODLCommon（输入到输出端口对）添加2个流条目，以在两个端口之间传输流量（进入北端口的流量路由到南端口，反之亦然）。ODLCommon为连接到AMS的每个端口添加两个流条目，以阻止返回ARP流量（以便在未配置AMS的情况下避免ARP洪泛）。该“公共业务层”流条目被设置为具有最低优先级。他们的柜台既不是统计收集也不是交通分流。当删除NetNode时，ODLCommon删除此公共流量底层流条目。</p>
<p><strong>FlowEntryMgr</strong> - 此模块提供了一个API，用于对ODC管理的SDN交换机中的流条目执行操作，并检索有关ODC管理的所有节点的信息。流条目操作包括在指定的NetNode（SDN交换机/路由器）中添加指定的流条目，移除流条目，切换流条目，获得流条目的详细信息以及读取由流条目收集的统计信息。FlowEntryMgr使用连接器模块与ODC通信。</p>
<p><strong>连接器</strong> - 此模块提供了包括REST通信的与ODC通信的基本API调用。在使用指定的ODC初始化连接详细信息后，连接器允许从ODC获取或删除数据，以及将数据发布或放入ODC。</p>
<p><strong>ODL REST Pojos</strong> - 此组Java类是ODC REST API的一部分，指定参数的Java类和与ODC交互的结果。</p>
<h2 id="基本控制流程"><a href="#基本控制流程" class="headerlink" title="基本控制流程"></a>基本控制流程</h2><p>控制流在逻辑上根据模块运行时依赖性排序，因此如果模块A依赖于模块B，则应在模块A之前初始化模块B，并在模块A之后终止。Defense4All应用程序模块依赖于大多数Framework模块，WebServer除外。</p>
<ul>
<li>启动 - Defense4All初始化所有模块并重新应用以前配置的基础架构和安全设置，从持久性存储库获取它们。在启动过程结束时，Defense4All恢复其先前的操作。</li>
<li>终止 - 重新启动 - Defense4All将任何相关数据保存到稳定的存储库中，并自行终止。如果终止是重新启动，则自动重新启动机制重新启动Defense4All。否则（如升级）Defense4All不会自动重启。</li>
<li>复位 - 在此流程中，所有模块都复位为出厂设置。这意味着将删除所有动态获取的数据以及用户配置。<h2 id="配置和设置流程"><a href="#配置和设置流程" class="headerlink" title="配置和设置流程"></a>配置和设置流程</h2></li>
<li>OFC（OpenFlowController = ODC） - 当DFMgmtPoint从DFRestService接收到添加OFC的请求时，它首先在OFC的Repo中添加OFC记录，然后通知ODLStatsCollectionRep和ODLDvsnRep，它们又通知ODL发起到添加的OFC（ODC）。ODL实例化用于与ODC通信的REST客户端。</li>
</ul>
<ul>
<li>NetNode - 可以添加多个NetNodes。每个NetNode对交换机或类似的网络设备及其流量端口，受保护的链路和与AMS的连接建模。当DFMgmtPoint从DFRestService接收到添加NetNode的请求时，它首先在NetNodes Repo中记录添加的NetNode，然后通知ODLStatsCollectionRep和ODLDvsnRep，然后通知MitigationMgr。ODLStatsCollectionRep和ODLDvsnRep然后通知ODL，并且ODL安装低优先级流条目以在受保护链路的端口对之间传递流量。MitigationMgr通知MitigationDriverLocal，它更新其NetNode-AMS连接组以从给定的NetNodes中转移AMS的一致性分配。</li>
</ul>
<ul>
<li>AMS - 可以添加多个AMS。当DFMgmtPoint从DFRestService接收到添加AMS的请求时，它首先在AMS的Repo中记录添加的AMS，然后通知AMSRep。AMSRep可以选择在添加的AMS中预配置保护功能，并开始监控其运行状况。</li>
</ul>
<ul>
<li>PN - 可以添加多个PN。当DFMgmtPoint从DFRestService接收到添加PN的请求时，它首先在PN的Repo中记录添加的PN，通知MitigationMgr，然后最终通知DetectionMgr。MitigationMgr通知MitigationDriverLocal，然后通知AMSRep。AMSRep可以预配置此PN的AMS以及其EventMgr以接受与该PN的业务相关的事件。DetectionMgr通知RateBasedDetector，然后通知StatsCollector。StatsCollector查询ODLStatsCollectionRep可能放置此PN的统计信息收集计数器。ODLStatsCollectionRep返回为此PN配置的所有NetNodes（如果没有配置，则返回当前已知为Defense4All的所有NetNodes）。StatsCollector“选择”计数器位置选项（此版本中唯一可用的选项）。对于每个NetNode，它然后询问ODLStatsCollectionRep以创建用于主题PN的计数器。计数器本质上是在每个北通信端口上针对感兴趣的协议（TCP，UDP，ICMP和其余IP）设置的一组流条目。计数器被给予优先级，并且这构成了平时通信量楼层（通过周期性地读取所有计数器流条目通信量计数值来监视通信量）。因为PN可以在重新启动时被重新引入，或者网络拓扑的改变可能需要重新计算计数器位置，所以一些/所有计数器可能已经就位。仅添加新计数器。不再删除的计数器。ODLStatsCollectionRep根据NetNode类型配置流条目。对于混合NetNodes，流条目操作是“发送到正常”（继续到传统路由），而对于本地NetNodes，操作是匹配输出端口（在每个受保护的链路中）。OdlStatsCollectionRep调用ODL来创建每个指定的流条目。后者调用FlowEntryMgr和Connector将请求发送到ODC。</li>
</ul>
<h2 id="攻击检测流程"><a href="#攻击检测流程" class="headerlink" title="攻击检测流程"></a>攻击检测流程</h2><p>周期性地，StatsCollector请求ODL StatsCollectionRep向ODC查询每个配置的PN的每个集合计数器的最新统计。ODLStatsCollectionRep调用FlowEntryMgr以获取计数器中每个流条目的统计信息。后者调用连接器从ODC获取所需的统计信息。</p>
<p>ODLStatsCollectionRep将获得的结果聚合在stats（每个协议的最新字节和包读取）向量中，并返回该向量。StatsCollector将每个计数器stats向量提供给DetectionMgr，然后它将stats向量转发到RateBasedDetector。RateBasedDetector维护每个计数器的统计信息以及每个PN的聚合计数器统计信息。统计信息包括先前读取的时间，以及对于每个协议的最新速率和指数平均值。</p>
<p>RateBasedDetector检查与平均值的显着和延长的最新速率偏差，并且如果在PN聚合等级中发现这样的偏差，则它通知攻击判断点关于攻击检测。只要偏差继续，RateBasedDetector继续通知AttackDecisionPoint关于检测。它为每个检测通知设置到期时间，并且可重复的通知基本上延长检测到期。</p>
<p>AttackDecisionPoint尊重所有检测。如果它已经声明对该协议端口的攻击，则AttackDecisionPoint将附加检测与该现有攻击相关联。否则，它会创建一个新的攻击，并通知MitigationMgr缓解该攻击（如下所述）。AttackDecisionPoint定期检查每个实时攻击的所有检测的状态。如果所有检测已过期，AttackDecisionPoint声明攻击结束，并通知MitigationMgr停止缓解攻击。</p>
<h2 id="攻击缓解流程"><a href="#攻击缓解流程" class="headerlink" title="攻击缓解流程"></a>攻击缓解流程</h2><p>MitigationMgr在接收到来自AttackDecisionPoint的缓解通知时，尝试找到插入的MitigationDriver来处理缓解。目前，它只请求插入MitigationDriverLocal。</p>
<p>MitigationDriverLocal检查是否存在已知，实时和可用的AMS，受攻击（或所有）流量可以从受攻击流量流经的NetNodes转向。它选择一个合适的AMS并在将攻击流量转移到所选择的AMS之前对其进行配置。例如，MitigationDriverLocal从Repo检索相关的协议平均值，并通过AMSRep在AMS中配置它们。</p>
<p>MitigationDriverLocal然后请求ODLDvsnRep将来自PN流量流经的每个NetNode的受攻击的PN协议端口（或所有PN）流量转移到所选择的AMS。</p>
<p>ODLDvsnRep创建新的最高优先级流量层（其包含优先级高于先前设置的流量层中的任何流条目的流条目）。流量层包含所有流条目，以转移和计数从每个入口/北行流量端口到AMS的流量，并且从AMS返回到相关输出（南向）端口。可选地，转向可以是“对称的”（在两个方向上），在这种情况下，流条目被添加以将流量从南向端口转移到AMS中，并且从AMS返回到北向端口。注意，StatsCollector将此添加的流量地板视为任何其他<strong>（？）</strong>，并将获取的统计信息从此层传递到DetectionMgr / RateBasedDetector。因为对于给定的PN，流量底板被聚合（在相同的NetNode中以及在NetNodes中），所以合并的速率保持与转移之前相同。与ODLStatsCollectionRep一样，ODLDvsnRep也使用较低级别的模块在所需的NetNodes中安装流条目。</p>
<p>最后，MitigationDriverLocal通知AMSRep可选地开始监视此攻击，并通知AttackDecisionPoint如果攻击继续或新的攻击发展。AMSRep可以通过AMSBasedDetector模块来实现。</p>
<p>如果MitigationDriverLocal找不到合适的AMS，或无法配置其任何缓解步骤，则它将中止缓解尝试，异步通知MitigationMgr。减缓措施然后保持在“无资源”状态。</p>
<p>当MitigationMgr接收到停止缓解攻击的通知时，它会将此通知转发到相关（且目前是唯一的）MitigationDriver，MitigationDriverLocal。MitigationDriverLocal在缓解开始时反转动作。它通知AMSRep停止监视此攻击，取消被攻击流量的转移，最后通知AMSRep可选地删除预缓解配置。</p>
<h2 id="问题和故障排除"><a href="#问题和故障排除" class="headerlink" title="问题和故障排除"></a>问题和故障排除</h2><p>(defense4all已经停止开发了，所以这部分无所谓了)<br>除了下面列出的过程，还参考Defense4All日志有关您遇到的具体问题的信息。Defense4All日志位于/var/log/Defense4All/server.log。</p>
<p>Defense4All无法启动 - 如果WebServer无法启动，请检查是否与端口号存在冲突。Defense4All使用端口8086.如果RepoFactory无法初始化，请检查Cassandra服务是否正在运行（sudo服务Cassandra停止/启动/重新启动）。如果Defense4All无法初始化，则问题可能在于系统资源（如线程或内存）。尝试重新启动机器。另一个问题可能会损坏Cassandra DF DB（键空间）。如果是，请尝试执行还原或重置（请参阅准则）。</p>
<p>Defense4All无法终止 - 可能是其WebServer崩溃。在这种情况下停止Defense4All的唯一方法是使用以下命令杀死其JVM Linux进程：kill -9 <defense4all-jvm-process-number></defense4all-jvm-process-number></p>
<p>Defense4All无法重置 - 启动Defense4All的一些问题也可能适用于重置。具体来说，Cassandra服务应该重置。如果重置失败，您可能需要手动清除Cassandra，如下所示：</p>
<p>卡桑德拉 - 克利<br>drop keyspace DF;<br>放弃;<br>Defense4All无法添加OFC - 检查故障原因（REST或CLI）。除了不正确的参数之外，问题可能是添加的PFC不存在或在API中指定的可寻址性（地址+端口）或安全性（用户+密码）。此外，Cassandra服务应该启动。</p>
<p>Defense4All无法添加NetNode - 检查故障原因（REST或API）。除了不正确的参数，Cassandra服务可能已关闭。</p>
<p>Defense4All无法添加AMS - 检查故障原因（REST或API）。除了不正确的参数，Cassandra服务可能已关闭。另外，问题可能在于AMS不存活或未连接。</p>
<p>Defense4All无法删除AMS - 检查故障原因（REST或API）。除了不正确的参数，Cassandra服务可能已关闭。另外，问题可能在于AMS不存活或未连接。</p>
<p>Defense4All无法添加PO - 检查失败原因（REST或API）。除了不正确的参数，Cassandra服务可能已关闭。此外，问题可能是PFC可能不存在并连接。</p>
<p>Defense4All无法删除PO - 检查失败原因（REST或API）。除了不正确的参数外，Cassandra服务可能已关闭。此外，问题可能是DF_GLOBAL_PNS表（列族）已损坏，因此应该完全删除，如下所示：</p>
<p>Cassandra-cli<br>使用DF;<br>截断列族DF_GLOBAL_PNS;<br>另一个问题可能是控制器没有启动，所以Defense4All无法删除它已经设置。</p>
<p>Defense4All无法检索/转储/清理飞行记录器日志记录 - 检查故障原因（REST或API）。除了不正确的参数外，Cassandra服务可能已关闭。此外，问题可能是FWORK_FLIGHT_RECORDER_EVENTS或FWORK_FLIGHT_RECORDER_SLICES表（列族）已损坏，因此两者都应完全删除，如下所示：</p>
<p>Cassandra-cli“<br>使用DF;<br>截断列族FWORK_FLIGHT_RECORDER_EVENTS;<br>截断列族FWORK_FLIGHT_RECORDER_SLICES;<br>警告：截断这些列族将导致当前存储在Cassandra中的所有航班记录的丢失。</p>
<p>Defense4All无法检索攻击或缓解 - 检查失败原因（REST或API）。除了不正确的参数外，Cassandra服务可能已关闭。此外，问题可能是DF_GLOBAL_ATTACKS / DF_GLOBAL_MITIGATIONS表（列族）已损坏，因此应该完全删除，如下所示：</p>
<p>Cassandra-cli<br>使用DF;<br>截断列族DF_GLOBAL_ATTACKS或DF_GLOBAL_MITIGATIONS;<br>警告：截断这些列族将导致丢失当前攻击和缓解的所有记录。在这种情况下，流量重定向流条目可能需要从所有相关的NetNodes手动删除（寻找优先级5X，7X，9X，等等，与action重定向）。</p>
<p>Defense4All操作错误和故障 - 根据错误/故障的性质，外部实体（Cassandra，PFC，NetNodes，AMS）的活性可能需要检查/重新启动。如果是内部Defense4All错误，应按此顺序尝试以下恢复步骤：</p>
<p>Defense4All重启<br>重新启动Defense4All宿主机<br>Defense4All重置并可能还原到较早的状态（以及手动清理由Defense4All设置的流条目和AMS配置）。<br>未检测到攻击 - 检查Defense4All日志，以查看在stats收集和检测机制中是否记录了任何错误。检查PFC和相关NetNodes是否存活。检查与平均值相比的最新速率。平均值可能偏斜，但重置Defense4All在攻击期间没有帮助，因为Defense4All将获得歪斜的平均值。等待攻击结束，然后重置Defense4All，并重新添加受攻击的PO。</p>
<p>缓解状态NO_RESOURCES - 这意味着Defense4All mitigationDriverLocal无法驱动此缓解，因为内部Defense4All错误或缺少AMS资源。如果确实没有AMS资源，则不需要恢复。否则检查相关AMS的活性。还要检查Cassandra是否正在运行，如果PFC已启动，并且如果相关的NetNode正在运行。如果存在Defense4All内部错误（根据Defense4All日志），则可能会在DF_GLOBAL_ATTACKS / DF_GLOBAL_MITIGATIONS表（列系列）中出现损坏，因此应全部删除，如下所示：</p>
<p>Cassandra-cli<br>使用DF;<br>截断列族DF_GLOBAL_ATTACKS或DF_GLOBAL_MITIGATIONS;<br>后续检测将重新创建相关的攻击和缓解记录。如果这没有帮助，请重新启动Defense4All。</p>
<p>缓解未终止 - 清除此缓解中的外部元素，如下所示：</p>
<p>手动删除相关攻击。<br>重新启动Defense4All。<br>重置Defense4All。<br>连续性<br>服务连续性（而不是高可用性）在这里定义为在存在中断事件的情况下以可承受的成本提供所需级别的服务的能力，其中</p>
<p>中断事件可以是加载，更改，逻辑错误，故障和灾难，管理操作（如升级），外部攻击等。<br>服务级别可以包括响应时间，吞吐量，数据/操作的生存性，安全/隐私等。对于每种类型的事件，在不同的事件处理阶段，所需的服务级别可以针对每个服务功能而不同。<br>成本可以包括人（数量，专业知识），设备（硬件，软件），设施（空间，电力）。<br>集群和容错 - 集群有助于解决可伸缩性和高可用性。如果其中一个集群成员失败，另一个集群成员可以快速承担其责任。这克服了成员故障，成员托管机器故障和成员网络连接故障。Defense4All集群安排在未来版本。在版本1.0中，Defense4All作为Linux可重新启动服务运行，因此如果它失败，托管Linux操作系统恢复Defense4All。这可以克服间歇性/偶发性Defense4All故障。Defense4All宿主机的故障意味着更长的时间和温和的额外的人类努力恢复机器及其托管的Defense4All。如果机器无法启动，Defense4All可以在网络中的另一台机器上启动。为了确保Defense4All恢复其操作（而不是从头开始重新启动），必须在该计算机上预加载Defense4All（最新或更早）状态快照。非集群环境会影响从机器故障中恢复的时间和人力。时间因素不那么重要，因为Defense4All运行路径不足，所以其较长的非可用性期间意味着较长的时间来检测和减轻新的攻击。</p>
<p>状态持久性 - Defense4All保持在同一台机器上运行的Cassandra DB中的状态。在版本1.0中，仅配置一个Cassandra实例集群。只要本地稳定存储不会崩溃，Linux4重新启动Defense4All服务就能使Defense4All从Cassandra快速检索其最新状态并恢复其最新操作。在发生故障和重新启动承载Defense4All的机器时也会发生同样的情况。采取Defense4All状态备份，并在另一台机器上恢复允许恢复该机器上的Defense4All操作。多节点Cassandra集群（计划用于未来版本）将增加状态持久性，同时减少恢复时间和工作量。</p>
<p>重新启动过程 - 当Defense4All（re）启动时，它首先检查保存的配置数据，并对所有相关模块重新执行配置步骤，驱动任何相关的外部编程和/或配置操作（例如针对PFC或AMS设备），例如，重新添加PO。此配置重放和原始配置之间的唯一区别是，保留任何动态获取的数据，例如所有PO统计信息。这允许轻松达到内部一致性，特别是在Defense4All或其主机计算机崩溃的情况下。当针对外部实体重放配置动作派生时，例如添加缺失的PO统计计数器，并且去除不再需要的计数器，也达到与外部实体的一致性。Defense4All变得可操作（启动其Web服务器），让您或一些其他组件根据可能的更改完成Defense4All缺少的配置，而Defense4All关闭。这导致达到端到端的一致性。</p>
<p>Reset - Defense4All允许您重置其动态获取的数据和配置信息（恢复出厂设置）。这使您能够克服许多逻辑错误和错误配置。注意，Defense4All重新启动或故障转移不会克服这样的问题。因此，这种机制是对重新启动 - 故障转移机制的补充，通常应该作为最后手段应用。</p>
<p>故障隔离和健康跟踪器 - 在Defense4All中，故障隔离以立即恢复或补偿（尽可能多）失败的形式发生，并在称为健康跟踪器的特殊模块中记录故障。除了少数实质性故障（例如无法启动框架），任何模块中的任何故障都不会立即导致Defense4All停止。相反，每个模块在其范围内记录每个故障，提供严重性规范和故障持久性的指示。如果所有故障的组合严重性（永久或临时）超过全局设置的阈值，HealthTracker会触发Defense4All关闭（并由Linux进行复原）。以后，永久或重复的临时故障将导致HealthTracker触发Defense4All软动态和动态重置（动态获取的数据）或建议管理员执行恢复出厂设置（也包括配置信息）。</p>
<p>状态备份和恢复 - 管理员可以对Defense4All状态进行快照，将备份保存在其他位置，然后恢复到原始或新的Defense4All位置。这允许克服某些逻辑错误和错误配置，以及承载Defense4All的机器的永久故障。要快照Defense4All状态，请执行以下操作：</p>
<p>停顿（关闭）Defense4All，导致当前状态刷新到稳定的存储）。避免在恢复时执行任何配置更改，避免新的状态更改。<br>获取Defense4All DB - “DF”的Cassandra快照：有关备份还原准则，请参阅 <a href="http://www.datastax.com/docs/1.0/operations/backup_restore。" rel="external nofollow noopener noreferrer" target="_blank">http://www.datastax.com/docs/1.0/operations/backup_restore。</a><br>将快照文件复制到所需的存储归档。<br>要将Defense4All备份恢复到目标计算机，请执行以下操作：</p>
<p>在目标计算机中恢复所需的已保存快照（与备份相同或不同）。有关Cassandra备份 - 恢复指南，请参阅<a href="http://www.datastax.com/docs/1.0/operations/" rel="external nofollow noopener noreferrer" target="_blank">http://www.datastax.com/docs/1.0/operations/</a> backup_restore。<br>在该机器上启动Cassandra。<br>在该机器上启动Defense4All。<br>维护和升级<br>关于升级的一个关键问题是数据的格式是否改变。未来版本的Defense4All将必须通过以下两种方式之一处理更改的数据格式：</p>
<p>作为升级过程的一部分，自动升级存储库中的状态格式<br>需要Defense4All重置，然后删除所有现有存储库表，然后创建新格式的表。<br>有关升级的另一个关键问题是与外部实体的兼容性：OFC，NetNodes和AMS。升级版本中的StatsCollectionRep，DvsnRep和AmsRep必须能够处理其外部实体，无论是从头开始还是从先前设置的配置和在运行时获得的数据。</p>
<p>Defense4All升级过程包括：</p>
<p>备份它的状态<br>或者出厂重置它<br>停止它<br>升级任何外部实体<br>升级它<br>（Re）启动它<br>要降级Defense4All：</p>
<p>出厂复位<br>停下来<br>降级任何外部实体<br>降级它<br>在升级之前恢复其备份状态<br>启动它<br>因为在这个版本Defense4All没有集群，集群滚动升级不适用这里。</p>
<p>新术语和概念<br>AMS - 攻击减轻系统，用于检测，减轻和报告网络攻击。例如，Radware的DefensePro是一种能够检测，减轻和报告大量网络攻击的AMS。<br>攻击 - 怀疑或检测到PN上的DDoS或其他网络攻击。攻击可以是网络链路，目的地址，协议或第4层端口的任何组合。Defense4All维持攻击生命周期，其中它试图根据每个主题PN的规范来减轻攻击。<br>检测 - 检测到监控的交通异常的指示。检测具有到期时间，并且可以更新。<br>缓解 - 正在执行以缓解给定攻击的活动。在本版本中，所有攻击都通过将攻击流量转移到DefensePro来缓解，并将干净的流量重新注入VTN。<br>NetNode - 模拟交换机或类似的网络设备，以及其流量端口，受保护的链路和与AMS的连接。NetNode指定一个或多个PN的业务通常流过（如果不被重定向）和/或AMS连接到的感兴趣的网络位置。在和平时间Defense4All通过该PN的业务流在每个网络中设置PN的计数器。攻击Defense4All选择一个或多个连接到引入的NetNodes的AMS，并将攻击/所有流量重定向到连接到这些NetNode的AMS。<br>OFC - 支持OpenFlow网络编程的SDN控制器（OFC代表OpenFlow控制器）。OpenDaylight控制器为支持OpenFlow的网络设备和其他网络设备提供这种风格。<br>受保护网络（PN） - 这是具有给定保护规范的用户定义的受保护网络元素。网络由两部分的任意组合指定：1）网络地址范围（并且可选地仅协议L4端口），以及2）指定业务流经过的网络链路。两个部分（但不是两者）中的任一个可以是未指定的。在版本1.0中，仅实现了第二部分。保护规范指示与对主题PN的攻击的检测和缓解相关的属性的范围。<br>受保护对象（PO​​） - 在Defense4All中，受保护网络（PN）称为受保护对象（PO​​）。<br>保护链路 - 交换机中的一组入口 - 出口端口。Defense4All通过要求在网络拓扑中设置为“bump-in-the-wire”的sdn-native开关，避免学习所有路由表。Defense4All程序使未攻击的流量进入其中一个入口 - 出口对端口以退出另一个。<br>sdn-hybrid和sdn- native - 有两种类型的SDN交换机：sdn-hybrid，它支持SDN和传统路由，sdn-native支持仅SDN路由。在sdn混合交换机上计数流量可以通过对具有期望的流量选择标准的流条目进行编程来完成，并且动作被发送到正常，意味着继续传统路由。对sdn本机交换机上的流量计数需要显式路由操作（将流量发送到哪个输出端口）。Defense4All通过需要一个sdn本地交换机来避免学习所有路由表，该交换机或多或少是相对于流量路由的线路，意味着进入端口1的业务通常退出端口2，进入端口3的业务通常退出端口4，反之亦然。这样的开关允许简单地对流条目进行编程，以便计数流量或将流量转移到附接的AMS /从附接的AMS转移流量。当Defense4All对包含端口1的选择标准的流量计数流条目进行编程时，其操作将输出到端口2，类似于3到4.此限制预计在将来的版本中取消。另请参阅受保护的链接项。<br>流量楼层 - 在给定的NetNode上Defense4All程序的一组流条目。不同的PN具有它们自己的业务层用于和平时间攻击检测，以及用于攻击缓解的业务重定向。攻击流量楼层包含优先级高于该PN的所有先前设置的攻击缓解流量楼层的流条目，以及平时流量楼层（其包含仅用于计数PN流量以便学习行为和异常的流条目）。攻击可以完全或部分地删除早期的攻击（例如TCP上的TCP端口80通过TCP或反之亦然）或不连接（例如TCP和UDP）。统计收集来自所有交通楼层：平时和攻击。基于SDN的检测器将所有统计信息汇总到总速率，确定攻击是否仍然开启。被削减的和平时间计数的交通可以显示零利率，并且计数由更高优先权的楼层计数器补充。<br>流量端口 - 北Vexternal，流量通过该端口进入PN的VTN。ProtectedLink是NetNode中的Vbridge的名称。<br>其他信息<br>安全和隐私<br>Defense4All REST API目前不检查凭据。它也不根据允许或限制某些REST API的使用来定义用户角色。</p>
<p>兼容性<br>这个Defense4All版本（1.0.7）与ODC 1.0兼容。AmsRep的参考实现是通过Radware的DefensePro版本：硬件版本ODS-VL，软件版本6.03,6.07和6.09。</p>
<p>性能和可伸缩性信息<br>TBD。</p>
<p>参考资料<br>[ODC]</p>
<p>返回Defense4All用户指南页面</p>
<p>隐私政策 关于OpenDaylight项目 免责声明<br> 的页面</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">SDN</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/SDN_defense4all.html">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-SDN_opendaylight_dev_bundle" class="article article-type-post  article-index" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/SDN_opendaylight_dev_bundle.html">在OpenDayLight控制器上开发Bundle</a>
    </h1>
  

        
        <a href="/SDN_opendaylight_dev_bundle.html" class="archive-article-date">
  	<time datetime="2017-01-08T05:24:31.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-01-08</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="在OpenDayLight控制器上开发Bundle"><a href="#在OpenDayLight控制器上开发Bundle" class="headerlink" title="在OpenDayLight控制器上开发Bundle"></a>在OpenDayLight控制器上开发Bundle</h2><hr>
<p><strong>odl远端仓库把startup project删除了。这个教程已经不再适用了。</strong><br>基于OpendayLight官网上的这篇文档翻译修改而来：<a href="http://docs.opendaylight.org/en/stable-boron/developer-guide/developing-apps-on-the-opendaylight-controller.html" rel="external nofollow noopener noreferrer" target="_blank">Developing Apps on the OpenDaylight controller
</a> </p>
<p>本文档适用于boron版本。其他版本不一定适用。</p>
<hr>
<h3 id="综述"><a href="#综述" class="headerlink" title="综述"></a>综述</h3><p>本文档旨在指导如何在ODL控制器上开发应用。本文档包含以下内容：</p>
<ol>
<li>创建一个简单的示例程序<code>Hello World</code>；</li>
<li>启动ODL控制器；</li>
<li>在<code>Hello World</code>测试简单的<code>Remote Procedure Call(RPC)</code>。</li>
</ol>
<h3 id="基础环境"><a href="#基础环境" class="headerlink" title="基础环境"></a>基础环境</h3><p>本文档需要以下基础开发环境：</p>
<ul>
<li>Maven 3.1.1 或更新的版本</li>
<li>JDK 7/8</li>
<li><p>合适的Maven <code>settings.xml</code>。可以通过一下途径获得默认的OpenDaylight <code>settings.xml</code></p>
  <figure class="highlight roboconf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cp -n ~/.m2/settings.xml&#123;,.<span class="attribute">orig&#125; ; \wget -q -O - https</span>://raw<span class="variable">.githubusercontent</span><span class="variable">.com</span>/opendaylight/odlparent/stable/boron/settings<span class="variable">.xml</span> &gt; ~/<span class="variable">.m</span>2/settings<span class="variable">.xml</span></div></pre></td></tr></table></figure>
<p>  <strong>在除Linux和Mac OS X以外的环境中，你需要修改上诉命令中maven的本地仓库地址<code>~/.m2/repository</code></strong></p>
</li>
</ul>
<h3 id="构建一个Example模块"><a href="#构建一个Example模块" class="headerlink" title="构建一个Example模块"></a>构建一个Example模块</h3><hr>
<p>按以下步骤构建：</p>
<ol>
<li><p>从Maven远端仓库中拉取一个初始工程。（第一次拉取的时候需要一定的时间）</p>
 <figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mvn archetype:generate -DarchetypeGroupId=org.opendaylight.controller -DarchetypeArtifactId=opendaylight-startup-archetype \</div><div class="line">-<span class="ruby">DarchetypeRepository=<span class="symbol">https:</span>/<span class="regexp">/nexus.opendaylight.org/content</span><span class="regexp">/repositories/public</span><span class="regexp">/ \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">DarchetypeCatalog=https:/</span><span class="regexp">/nexus.opendaylight.org/content</span><span class="regexp">/repositories/public</span><span class="regexp">/archetype-catalog.xml</span></span></div></pre></td></tr></table></figure>
<p> 在国内，由于墙的缘故，你可能需要设置代理才能较快的下载工程。设置代理的参数如下：</p>
 <figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">-DsocksProxyHost</span>=YourProxyHost -DsocksProxyPort=YourProxyPort</div></pre></td></tr></table></figure>
<p> 此外你还可以使用多线程编译，跳过生成文档，跳过测试来加快速度：</p>
 <figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-T <span class="number">1</span>C -D maven<span class="selector-class">.javadoc</span><span class="selector-class">.skip</span>=true -DskipTests</div></pre></td></tr></table></figure>
</li>
<li><p>使用如下值来初始化工程：</p>
 <figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'groupId'</span>: : org.opendaylight.example</div><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'artifactId'</span>: : example</div><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'version'</span>:  <span class="number">1.0</span>-SNAPSHOT: : <span class="number">1.0</span>.<span class="number">0</span>-SNAPSHOT</div><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'package'</span>:  org.opendaylight.example: :</div><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'classPrefix'</span>: : $&#123;artifactId.substring(<span class="number">0</span>,<span class="number">1</span>).toUpperCase()&#125;$&#123;artifactId.substring(<span class="number">1</span>)&#125;</div><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'copyright'</span>: : Copyright (c) <span class="number">2015</span> Yoyodyne, Inc.</div></pre></td></tr></table></figure>
<p> 其中，<code>version</code>,<code>package</code>,<code>classPrefix</code>都会默认填写，直接回车就行。</p>
</li>
<li><p>完成步骤1,2后，可以看到一个<code>example</code>文件夹。可以看到如下目录结构。</p>
 <figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$&#123;artifactId&#125;/</div><div class="line"><span class="built_in">example</span>/</div><div class="line">cd <span class="built_in">example</span>/</div><div class="line">api/</div><div class="line">artifacts/</div><div class="line"><span class="built_in">features</span>/</div><div class="line">impl/</div><div class="line">karaf/</div><div class="line">pom.xml</div></pre></td></tr></table></figure>
</li>
<li><p>构建示例工程。<br> <strong>注意，这个可能需要耗费一定的时间，你可以使用1中提到的maven参数来提升编译速度。</strong></p>
 <figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">mvn </span>clean install</div></pre></td></tr></table></figure>
</li>
<li><p>启动ODL控制器。</p>
 <figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">cd</span> karaf/target/assembly/bin</div><div class="line"><span class="keyword">ls</span></div><div class="line">./karaf</div></pre></td></tr></table></figure>
</li>
<li><p>等待直至启动完毕出现以下命令行。可能需要等一段时间，这个时间和你电脑配置有关。</p>
 <figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">opendaylight-user<span class="meta">@root</span>&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>查看日志，确认<code>example</code>模块被正常加载。</p>
 <figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">lo</span><span class="variable">g:display</span> | <span class="keyword">grep</span> Example</div></pre></td></tr></table></figure>
</li>
<li><p>关闭ODL控制器。</p>
 <figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">shutdown</span> -f</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="定义一个简单的-Hello-World-RPC"><a href="#定义一个简单的-Hello-World-RPC" class="headerlink" title="定义一个简单的`Hello World RPC"></a>定义一个简单的<code>`Hello World</code> RPC</h3><ol>
<li><p>从maven远端仓库拉取初始工程。</p>
 <figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mvn archetype:generate -DarchetypeGroupId=org.opendaylight.controller -DarchetypeArtifactId=opendaylight-startup-archetype \</div><div class="line">  -<span class="ruby">DarchetypeRepository=<span class="symbol">http:</span>/<span class="regexp">/nexus.opendaylight.org/content</span><span class="regexp">/repositories/opendaylight</span>.release/ \</span></div><div class="line">  -<span class="ruby">DarchetypeCatalog=<span class="symbol">http:</span>/<span class="regexp">/nexus.opendaylight.org/content</span><span class="regexp">/repositories/opendaylight</span>.release/archetype-catalog.xml</span></div></pre></td></tr></table></figure>
<blockquote>
<p>这里需要注意，原文中使用的是<code>snapshot</code>，而使用<code>snapshot</code>会出现无法编译通过的问题。本文中使用<code>release</code>版本且目前的maven远端仓库<code>release</code>版本是<code>boron</code>。  </p>
</blockquote>
</li>
<li><p>使用如下值来初始化工程：</p>
 <figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'groupId'</span>: : org.opendaylight.hello</div><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'artifactId'</span>: : hello</div><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'version'</span>:  <span class="number">1.0</span>-SNAPSHOT: : <span class="number">1.0</span>.<span class="number">0</span>-SNAPSHOT</div><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'package'</span>:  org.opendaylight.hello: :</div><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'classPrefix'</span>: : $&#123;artifactId.substring(<span class="number">0</span>,<span class="number">1</span>).toUpperCase()&#125;$&#123;artifactId.substring(<span class="number">1</span>)&#125;</div><div class="line">Define <span class="keyword">value</span> <span class="keyword">for</span> property <span class="string">'copyright'</span>: : Copyright (c) <span class="number">2015</span> Yoyodyne, Inc.</div></pre></td></tr></table></figure>
<p> 其中，<code>version</code>,<code>package</code>,<code>classPrefix</code>都会默认填写，直接回车就行。</p>
</li>
<li><p>查看<code>hello</code>工程。</p>
 <figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">cd</span> hello/</div><div class="line"><span class="keyword">ls</span> -1</div><div class="line">api</div><div class="line">artifacts</div><div class="line">features</div><div class="line">impl</div><div class="line">karaf</div><div class="line">pom.xml</div></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>构建<code>Hello</code>工程。</p>
 <figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">mvn </span>clean install</div></pre></td></tr></table></figure>
<blockquote>
<p>同样，可以利用之前提到的参数来提升编译构建速度。 </p>
</blockquote>
</li>
<li><p>启动ODL控制器。</p>
 <figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">cd</span> karaf/target/assembly/bin</div><div class="line"><span class="keyword">ls</span></div><div class="line">./karaf</div></pre></td></tr></table></figure>
</li>
<li><p>等待直至启动完毕出现以下命令行。可能需要等一段时间，这个时间和你电脑配置有关。</p>
 <figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">opendaylight-user<span class="meta">@root</span>&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>查看日志，确认<code>Hello</code>模块被正常加载。</p>
 <figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">lo</span><span class="variable">g:display</span> | <span class="keyword">grep</span> Hello</div></pre></td></tr></table></figure>
</li>
<li><p>关闭ODL控制器。</p>
 <figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">shutdown</span> -f</div></pre></td></tr></table></figure>
</li>
<li><p>返回到<code>Hello</code>目录：</p>
 <figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd ../../../../</div></pre></td></tr></table></figure>
</li>
<li><p>可以通过查看<code>Hello</code>模块的实现来了解7中的日志从何而来，模块实现源文件路径如下：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">impl<span class="regexp">/src/m</span>ain<span class="regexp">/java/</span>org<span class="regexp">/opendaylight/</span>hello<span class="regexp">/impl/</span>HelloProvider.java</div></pre></td></tr></table></figure>
</li>
<li><p>可以使用<code>HelloProvider.onSessionInitiate</code>方法来添加自己的实现。 </p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onSessionInitiated</span><span class="params">(ProviderContext session)</span> </span>&#123;</div><div class="line">    LOG.info(<span class="string">"HelloProvider Session Initiated"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="添加一个简单的HelloWorld-RPC-API"><a href="#添加一个简单的HelloWorld-RPC-API" class="headerlink" title="添加一个简单的HelloWorld RPC API"></a>添加一个简单的<code>HelloWorld</code> RPC API</h3><hr>
<ol>
<li><p>修改YANG文件。</p>
 <figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi api<span class="regexp">/src/m</span>ain<span class="regexp">/yang/</span>hello.yang</div></pre></td></tr></table></figure>
</li>
<li><p>修改为如下文件，通过修改该文件来定义<code>hello-world</code> RPC：</p>
 <figure class="highlight puppet"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"> module <span class="keyword">hello</span> &#123;</div><div class="line">    yang-version <span class="number">1</span>;</div><div class="line">    namespace <span class="string">"urn:opendaylight:params:xml:ns:yang:hello"</span>;</div><div class="line">    prefix <span class="string">"hello"</span>;</div><div class="line">    revision <span class="string">"2015-01-05"</span> &#123;</div><div class="line">        <span class="literal">description</span> <span class="string">"Initial revision of hello model"</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">rpc</span> <span class="keyword">hello</span>-<span class="keyword">world</span> &#123;</div><div class="line">        input &#123;</div><div class="line">            leaf <span class="literal">name</span> &#123;</div><div class="line">                <span class="built_in">type</span> string;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">output</span> &#123;</div><div class="line">            leaf greating &#123;</div><div class="line">                <span class="built_in">type</span> string;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>返回到<code>hello/api</code>目录并构建你的API:</p>
 <figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd ../../../</div><div class="line">mvn clean install</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="实现HelloWorld-RPC-API"><a href="#实现HelloWorld-RPC-API" class="headerlink" title="实现HelloWorld RPC API"></a>实现<code>HelloWorld</code> RPC API</h3><hr>
<ol>
<li><p>定义<code>HelloService</code>，该服务会被<code>HelloWorld</code>API调用。</p>
 <figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd ..<span class="regexp">/impl/</span>src<span class="regexp">/main/</span>java<span class="regexp">/org/</span>opendaylight<span class="regexp">/hello/im</span>pl<span class="regexp">/</span></div></pre></td></tr></table></figure>
</li>
<li><p>创建<code>HelloWorldImpl.java</code>文件，添加如下代码：</p>
 <figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">* Copyright © 2016 Cisco Systems and others.  All rights reserved.</div><div class="line">*</div><div class="line">* This program and the accompanying materials are made available under the</div><div class="line">* terms of the Eclipse Public License v1.0 which accompanies this distribution,</div><div class="line">* and is available at http://www.eclipse.org/legal/epl-v10.html</div><div class="line">*/</div><div class="line">package org.opendaylight.hello.impl;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.Future;</div><div class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.opendaylight.<span class="keyword">params</span>.<span class="built_in">xml</span>.ns.yang.hello.rev150105.HelloService;</div><div class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.opendaylight.<span class="keyword">params</span>.<span class="built_in">xml</span>.ns.yang.hello.rev150105.HelloWorldInput;</div><div class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.opendaylight.<span class="keyword">params</span>.<span class="built_in">xml</span>.ns.yang.hello.rev150105.HelloWorldOutput;</div><div class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.opendaylight.<span class="keyword">params</span>.<span class="built_in">xml</span>.ns.yang.hello.rev150105.HelloWorldOutputBuilder;</div><div class="line"><span class="keyword">import</span> org.opendaylight.yangtools.yang.common.RpcResult;</div><div class="line"><span class="keyword">import</span> org.opendaylight.yangtools.yang.common.RpcResultBuilder;</div><div class="line"><span class="keyword">public</span> class HelloWorldImpl implements HelloService &#123;</div><div class="line">    @Override</div><div class="line">    <span class="keyword">public</span> Future&lt;RpcResult&lt;HelloWorldOutput&gt;&gt; helloWorld(HelloWorldInput input) &#123;</div><div class="line">        HelloWorldOutputBuilder helloBuilder = <span class="literal">new</span> HelloWorldOutputBuilder();</div><div class="line">        helloBuilder.setGreating(<span class="string">"Hello "</span> + input.getName());</div><div class="line">        <span class="keyword">return</span> RpcResultBuilder.success(helloBuilder.build()).buildFuture();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>修改<code>HelloProvider.java</code>.注册在<code>hello.yang</code>中创建的RPC. 你可以自己添加自己想要的实现，或者直接按如下编写：</p>
 <figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"> * Copyright © 2016 Cisco Systems and others.  All rights reserved.</div><div class="line"> *</div><div class="line"> * This program and the accompanying materials are made available under the</div><div class="line"> * terms of the Eclipse Public License v1.0 which accompanies this distribution,</div><div class="line"> * and is available at http://www.eclipse.org/legal/epl-v10.html</div><div class="line"> */</div><div class="line">package org.opendaylight.hello.impl;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.opendaylight.controller.md.sal.binding.api.DataBroker;</div><div class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.binding.api.RpcProviderRegistry;</div><div class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.binding.api.BindingAwareBroker.RpcRegistration;</div><div class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.opendaylight.params.xml.ns.yang.hello.rev150105.HelloService;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.slf4j.Logger;</div><div class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloProvider</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="type">LOG</span> = <span class="type">LoggerFactory</span>.getLogger(<span class="type">HelloProvider</span>.<span class="keyword">class</span>);</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">DataBroker</span> dataBroker;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">RpcProviderRegistry</span> rpcProviderRegistry;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="type">RpcRegistration</span>&lt;<span class="type">HelloService</span>&gt; serviceRegistration;</div><div class="line">    <span class="keyword">public</span> <span class="type">HelloProvider</span>(<span class="keyword">final</span> <span class="type">DataBroker</span> dataBroker, <span class="type">RpcProviderRegistry</span> rpcProviderRegistry) &#123;</div><div class="line">        this.dataBroker = dataBroker;</div><div class="line">        this.rpcProviderRegistry = rpcProviderRegistry;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Method called when the blueprint container is created.</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> void <span class="keyword">init</span>() &#123;</div><div class="line"> serviceRegistration = rpcProviderRegistry.addRpcImplementation(<span class="type">HelloService</span>.<span class="keyword">class</span>, new <span class="type">HelloWorldImpl</span>());</div><div class="line">        <span class="type">LOG</span>.info(<span class="string">"HelloProvider Session Initiated"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">    * Method called when the blueprint container is destroyed.</div><div class="line">    */</div><div class="line">    <span class="keyword">public</span> void close() &#123;</div><div class="line"> serviceRegistration.close();</div><div class="line">        <span class="type">LOG</span>.info(<span class="string">"HelloProvider Closed"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>&gt; 这边需要注意：文件开头的版权声明不能去掉，否则无法通过Maven构建。此外，官网上的源文件有问题。本文档的源文件至少通过了本地编译。
</code></pre><ol>
<li><p>此外，需要在BluePrint中注册你的RPC API.修改如下：</p>
 <figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd hello<span class="meta-keyword">/impl/</span>src<span class="meta-keyword">/main/</span>resources<span class="meta-keyword">/org/</span>opendaylight/blueprint</div><div class="line">vi impl-blueprint.xml</div></pre></td></tr></table></figure>
<p> 修改为如下。</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="comment">&lt;!-- vi: set et smarttab sw=4 tabstop=4: --&gt;</span></div><div class="line"><span class="comment">&lt;!--</span></div><div class="line">Copyright © 2016 Cisco Systems and others. All rights reserved.</div><div class="line"></div><div class="line">This program and the accompanying materials are made available under the</div><div class="line">terms of the Eclipse Public License v1.0 which accompanies this distribution,</div><div class="line">and is available at http://www.eclipse.org/legal/epl-v10.html</div><div class="line">--&gt;</div><div class="line"><span class="tag">&lt;<span class="name">blueprint</span> <span class="attr">xmlns</span>=<span class="string">"http://www.osgi.org/xmlns/blueprint/v1.0.0"</span></span></div><div class="line"><span class="attr">xmlns:odl</span>=<span class="string">"http://opendaylight.org/xmlns/blueprint/v1.0.0"</span></div><div class="line"><span class="attr">odl:use-default-for-reference-types</span>=<span class="string">"true"</span>&gt;</div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">reference</span> <span class="attr">id</span>=<span class="string">"dataBroker"</span></span></div><div class="line">    <span class="attr">interface</span>=<span class="string">"org.opendaylight.controller.md.sal.binding.api.DataBroker"</span></div><div class="line">    <span class="attr">odl:type</span>=<span class="string">"default"</span> /&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">reference</span> <span class="attr">id</span>=<span class="string">"rpcRegistry"</span></span></div><div class="line">    <span class="attr">interface</span>=<span class="string">"org.opendaylight.controller.sal.binding.api.RpcProviderRegistry"</span> /&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"provider"</span></span></div><div class="line">    <span class="attr">class</span>=<span class="string">"org.opendaylight.hello.impl.HelloProvider"</span></div><div class="line">    <span class="attr">init-method</span>=<span class="string">"init"</span> <span class="attr">destroy-method</span>=<span class="string">"close"</span>&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">argument</span> <span class="attr">ref</span>=<span class="string">"dataBroker"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">argument</span> <span class="attr">ref</span>=<span class="string">"rpcRegistry"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">blueprint</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>&gt; 这个文档中添加了`rpcRegistry`。需要注意&lt;?xml&gt;前不能有空格。
</code></pre><ol>
<li><p>然后回到hello/impl目录下编译。</p>
 <figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">mvn </span>clean install</div></pre></td></tr></table></figure>
</li>
<li><p>回到hello目录下编译。</p>
 <figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">mvn </span>clean install</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="通过REST来测试hello-world-RPC"><a href="#通过REST来测试hello-world-RPC" class="headerlink" title="通过REST来测试hello-world RPC"></a>通过REST来测试<code>hello-world</code> RPC</h3><hr>
<p>有很多方式可以测试RPC, 比如以下两种。</p>
<ol>
<li><p>通过HTTP使用ODL控制器自带的API Explorer</p>
</li>
<li><p>使用浏览器的REST 客户端</p>
</li>
</ol>
<h4 id="通过HTTP使用ODL控制器自带的API-Explorer"><a href="#通过HTTP使用ODL控制器自带的API-Explorer" class="headerlink" title="通过HTTP使用ODL控制器自带的API Explorer"></a>通过HTTP使用ODL控制器自带的API Explorer</h4><hr>
<ol>
<li><p>使用浏览器进入 <a href="http://localhost:8181/apidoc/explorer/index.html" rel="external nofollow noopener noreferrer" target="_blank">apidoc UI</a><code>&lt;http://localhost:8181/apidoc/explorer/index.html&gt;</code> 。</p>
<blockquote>
<p>TIP: <strong>localhost</strong>是你ODL控制器的IP地址或者Hostname。</p>
</blockquote>
</li>
<li><p>选择</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">hello(<span class="number">2015</span><span class="number">-01</span><span class="number">-05</span>)</div></pre></td></tr></table></figure>
</li>
<li><p>选择</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">POST <span class="regexp">/operations/</span><span class="string">hello:</span>hello-world</div></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>在框内填写如下值</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&#123;<span class="attr">"hello:input"</span>: &#123; <span class="attr">"name"</span>:<span class="string">"Your Name"</span>&#125;&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>点击按钮.</p>
</li>
<li><p>输入 username 和 password, 默认是<br><code>admin/admin</code>.</p>
</li>
<li><p>返回的Response body应该为：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&#123;</div><div class="line">  <span class="attr">"output"</span>: &#123;</div><div class="line">    <span class="attr">"greating"</span>: <span class="string">"Hello Your Name"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="使用浏览器的REST-客户端"><a href="#使用浏览器的REST-客户端" class="headerlink" title="使用浏览器的REST 客户端"></a>使用浏览器的REST 客户端</h3><hr>
<p>可以使用火狐浏览器的 <a href="https://github.com/chao/RESTClient" rel="external nofollow noopener noreferrer" target="_blank"><em>RESTClient</em></a>或者Chrome的<code>Restlet Client</code>。<br>    <figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">POST:</span> <span class="symbol">http:</span>/<span class="regexp">/192.168.1.43:8181/restconf</span><span class="regexp">/operations/hello</span><span class="symbol">:hello-world</span></div></pre></td></tr></table></figure></p>
<p>Header:  </p>
<pre><code>```
application/json
```   
</code></pre><p>Body:  </p>
<pre><code>{&quot;input&quot;: {
    &quot;name&quot;: &quot;Andrew&quot;
  }
}
</code></pre><h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><p>If you get a response code 501 while attempting to POST<br>/operations/hello:hello-world, check the file: HelloProvider.java and<br>make sure the helloService member is being set. By not invoking<br>“session.addRpcImplementation()” the REST API will be unable to map<br>/operations/hello:hello-world url to HelloWorldImpl.</p>
<blockquote>
<p>这个应该碰不到了。所以就不翻译了。</p>
</blockquote>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">SDN</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/SDN_opendaylight_dev_bundle.html">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-SDN_Link" class="article article-type-post  article-index" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/SDN_Link.html">SDN收藏夹</a>
    </h1>
  

        
        <a href="/SDN_Link.html" class="archive-article-date">
  	<time datetime="2017-01-08T05:24:31.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-01-08</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="SDN收藏夹"><a href="#SDN收藏夹" class="headerlink" title="SDN收藏夹"></a>SDN收藏夹</h2><hr>
<h3 id="OpenDayLight操作"><a href="#OpenDayLight操作" class="headerlink" title="OpenDayLight操作"></a>OpenDayLight操作</h3><p><a href="http://www.sdnlab.com/1749.html" rel="external nofollow noopener noreferrer" target="_blank">ODL与mininet</a><br><a href="http://docs.opendaylight.org/en/stable-boron/getting-started-guide/common-features/clustering.html" rel="external nofollow noopener noreferrer" target="_blank">ODL控制器集群</a><br><a href="https://github.com/yeasy/tech_writing/blob/master/SDN/OpenDaylight%20Controller%20%E7%AE%80%E6%98%93%E5%85%A5%E9%97%A8.pdf" rel="external nofollow noopener noreferrer" target="_blank">简单入门(13年12月)</a>  </p>
<hr>
<h3 id="OpenDayLight编程开发"><a href="#OpenDayLight编程开发" class="headerlink" title="OpenDayLight编程开发"></a>OpenDayLight编程开发</h3><p><a href="http://blog.csdn.net/heriam/article/details/50411303" rel="external nofollow noopener noreferrer" target="_blank">Linux编译环境搭建</a><br><a href="http://www.sdnlab.com/17124.html" rel="external nofollow noopener noreferrer" target="_blank">windows下环境搭建</a>(<a href="http://www.sdnlab.com/author/3836/" rel="external nofollow noopener noreferrer" target="_blank">该文作者系列文章</a>)<br><a href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:Building_from_CLI" rel="external nofollow noopener noreferrer" target="_blank">官方maven编译安装教程</a><strong>注意maven编译的时候可能需要使用代理来访问远端maven仓库</strong><br><a href="http://www.sdnlab.com/11405.html" rel="external nofollow noopener noreferrer" target="_blank">控制器上bundle的二次开发</a><br><a href="http://blog.csdn.net/pantingting_zju/article/details/46835081" rel="external nofollow noopener noreferrer" target="_blank">开发一个bundle</a>(已经过期无法按照原文步骤演示了，但是可以看看。<a href="http://www.frank-durr.de/?p=84" rel="external nofollow noopener noreferrer" target="_blank">原文</a>)<br><a href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:Sample_Applications/SampleStatisticsApplication" rel="external nofollow noopener noreferrer" target="_blank">利用北向接口NBI来写一个统计程序</a><br><a href="http://docs.opendaylight.org/en/stable-boron/developer-guide/developing-apps-on-the-opendaylight-controller.html" rel="external nofollow noopener noreferrer" target="_blank">官方开发控制器app文档</a><br><a href="http://www.sdnlab.com/18270.html" rel="external nofollow noopener noreferrer" target="_blank">YANG模型</a>  </p>
<hr>
<h3 id="OpenDayLight-源码与API"><a href="#OpenDayLight-源码与API" class="headerlink" title="OpenDayLight 源码与API"></a>OpenDayLight 源码与API</h3><p><a href="http://blog.csdn.net/sdnlab/article/details/44651161" rel="external nofollow noopener noreferrer" target="_blank">ODL 氢版本数据通讯版本源码解读</a><br><a href="https://wiki.opendaylight.org/view/Defense4All:Tutorial" rel="external nofollow noopener noreferrer" target="_blank">defenseAll (已被odl官方存档弃用)</a><br><a href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:MD-SAL:Component_Map" rel="external nofollow noopener noreferrer" target="_blank">控制器mdsal组件列表</a><br><a href="https://nexus.opendaylight.org/content/sites/site/org.opendaylight.mdsal/beryllium/apidocs/" rel="external nofollow noopener noreferrer" target="_blank">ODL beryllium版本API，已过期</a><br><a href="https://nexus.opendaylight.org/content/sites/site/org.opendaylight.mdsal/boron/apidocs/" rel="external nofollow noopener noreferrer" target="_blank">ODL boron版本API，目前最新(1/6/2017)</a><br><a href="https://git.opendaylight.org/gerrit/#/admin/projects/" rel="external nofollow noopener noreferrer" target="_blank">官方Git</a>  </p>
<hr>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p><a href="http://www.muzixing.com/pages/2015/08/30/sdnkong-zhi-ping-mian-fa-zhan-li-shi-ji-qu-shi.html" rel="external nofollow noopener noreferrer" target="_blank">sdn架构</a><br><a href="http://blog.csdn.net/yuzhihui_no1/article/details/39161515" rel="external nofollow noopener noreferrer" target="_blank">ovs模块划分</a><br><a href="http://blog.csdn.net/yuzhihui_no1/article/details/41546481" rel="external nofollow noopener noreferrer" target="_blank">ovs源码分析系列</a><br><a href="https://wiki.opendaylight.org/view/Network_Intent_Composition:Use_Cases#Suspicious_DDoS_activity_monitoring" rel="external nofollow noopener noreferrer" target="_blank">ODL用户邮件(感觉有用，但是不知道怎么用)</a><br><a href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:Load_Balancer_Service" rel="external nofollow noopener noreferrer" target="_blank">ODL 负载均衡演示(已过期)</a><br><a href="http://docs.opendaylight.org/en/stable-boron/getting-started-guide/security_considerations.html" rel="external nofollow noopener noreferrer" target="_blank">ODL安全措施，没啥用</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">SDN</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/SDN_Link.html">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-SDN_conclusion" class="article article-type-post  article-index" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/SDN_conclusion.html">SDN综述</a>
    </h1>
  

        
        <a href="/SDN_conclusion.html" class="archive-article-date">
  	<time datetime="2016-12-18T05:24:31.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-12-18</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="论文"><a href="#论文" class="headerlink" title="论文"></a>论文</h2><p><a href="论文：软件定义网络(SDN)研究进展.Tutorial)">^1</a></p>
<h2 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h2><p>利用分层思想，将数据与控制分离。<br>控制层有逻辑中心化和可编程控制器。数据层有dump 交换机，只负责数据的转发，课快速处理匹配数据包，适应流量日益增长的需求。两层之间采用开放统一的接口（比如openflow）交互。控制器通过接口下发规则，交换机按照规则执行工作。</p>
<h2 id="体系结构"><a href="#体系结构" class="headerlink" title="体系结构"></a>体系结构</h2><h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><p><img src="https://www.opennetworking.org/images/stories/sdn-resources/meet-sdn/sdn-3layers.gif" alt="SDN体系结构"><a href="论文：软件定义网络(SDN)研究进展.Tutorial)">^1</a><br>SDN由北向南分为三个接口：数据平面、控制平面、和应用平面。数据平面与控制平面之间利用用SDN控制数据平面接口(<code>control-data-plane  interface</code>，简称CDPI)进行通信。CDPI有统一的标准，目前是 OpenFlow协议。控制平面与应用平面之间采用SDN北向接口(northbound interface，简称NBI)。NBI可以依照用于实际需求定制。</p>
<p>数据平面由交换机等网络元素链接。可以将至视为传统的数据链路，负责网络之间的数据交互，并接受上层的控制。控制平面是中间件，通过CDPI驱动来监控管理数据平面中的网络元素的行为，并通过北向接口来接收应用层的命令。应用平面包含各类基于SDN的网络应用，用户无需关心底层实现，就可以通过简单编程实现应用的快速部署。网络抽象特性允许用户可以根据需求选择不同的网络操作系<br>统，而并不影响物理设备的正常运行。</p>
<h3 id="不同方向"><a href="#不同方向" class="headerlink" title="不同方向"></a>不同方向</h3><p>NFV(Network Function Virtulizaiton),是指将传统的网络功能虚拟化，使之独立于硬件。在相同的硬件上，可以运行不同的网络功能。从而减少专属设备的硬件成本。NVF用了资源虚拟化的方式，在硬件设备中建立一个网络虚拟层，负责将硬件<br>资源虚拟化，形成虚拟计算资源、虚拟存储资源和虚拟网络资源等，运营商通过软件来管理这些虚拟资源．由于<br>采用的是通用硬件设备，NFV降低了设备成本，减少了能耗，缩短了新网络服务的部署周期，从而适应网络运营<br>商的发展需求．在接口设计方面，NFV既可以基于非OpenFlow协议，又能与OpenFlow协同工作，同时还支持<br>ForCES等多种传统接口标准化协议，以便适应网络运营商对设备的不同需求，并与ONF的SDN保持相对独<br>立的发展．</p>
<p>OpenDaylight是一套以社区为主导的开源框架,旨在推动创新实施以及SDN透明化。考虑到兼容性问题，OpenDaylight继承了SDN架构形式，同时又结合了NFV的特<br>点．架构共分为3个层次，分别是网络应用与业务流程(即应用层)、控制平台(即控制层)和物理与虚拟网络设备(即数据层)．OpenDaylight的控制平台直接由自带的Java虚拟机实现．针对不同的网络任务，控制器自身携带了一系列可插入模块，并兼容第三方模块以增强SDN的功能．与ONF的SDN架构最大的不同在于：OpenDaylight控制器的南向接口除了支持OpenFlow协议之外，还支持NETCONF等配置协议和BGPt24等路由协议，并支持生产厂商的专有协议(如思科的OnePK协议)．为了能够处理不同的标准协议，OpenDaylight增加了服务抽象层SAL，它负责将不同的底层协议标准转换成OpenDaylight控制层所理解的请求服务，保持了底层协议的透明性，并提高了整体架构的可扩展性．</p>
<h3 id="开放式接口与协议设计"><a href="#开放式接口与协议设计" class="headerlink" title="开放式接口与协议设计"></a>开放式接口与协议设计</h3><p>SDN接口中，以控制器为中心，南向与数据层通信，北向与应用层通信。并支持多控制器，在东西向进行多控制器通信。<br>作为数据与控制分离的核心，南向接口是目前相对研究比较多的点。比如ONF的CDPI,采用openflow。Openflow基于流的概念来匹配规则，交换机通过维护流表（Flow table）来支持openflow，按流表进行数据转发。流表的建立，维护及下发由控制器进行。</p>
<p>对于北向的研究，有ONF的NBI，OpenDaylight的REST等。这一方面的研究在于如何实现统一的北向接口标准。 东西向接口为负载均衡和性能提升提供保障。</p>
<h2 id="数据层关键技术"><a href="#数据层关键技术" class="headerlink" title="数据层关键技术"></a>数据层关键技术</h2><p>在SDN中，数据层与控制层分离，控制策略部分被交给控制器负责，数据层上的研究主要集中在交换机设计和转发规则。</p>
<h3 id="交换机设计问题"><a href="#交换机设计问题" class="headerlink" title="交换机设计问题"></a>交换机设计问题</h3><p>SDN交换机位于数据层面。用来负责数据流转发。可以使用硬件和软件两种方式进行转发。硬件转发速度快，成本低，功耗小，但是灵活性不够。对此，Bosshart等人[^32]提出了针对数据平面转发的RMT模型。允许在流水线阶段支持任意宽度和深度的流表。  </p>
<ol>
<li>允许随意替换或增加域定义；</li>
<li>允许指定流表的数量、拓扑、宽度和深度，仅仅受限于芯片的整体资源(如芯片内存大小等)；</li>
<li>允许创建新动作；</li>
<li>可以随意将数据包放到不同的队列中，并指定发送端口。  </li>
</ol>
<p>此外，FlowAdapter是另一种利用硬件灵活处理的技术。FlowAdapter采用三层结构。最上层是可以通过更新来支持任何新协议的软件数据平面，底层是相对固定但转发效率高的硬件数据平面，位于中部的FlowAdapter层负责软件数据平面和硬件数据平面之间的通信．当控制器下发规则时，软件数据平面将存储这些规则，形成M个阶段的流表．由于这些规则相对灵活，不能全部<br>由交换机直接转化成相应转发动作，而硬件数据平面可以实现规则的高速匹配转发．因此可利用中间层FlowAdapter将两个数据平面中的规则进行无缝转换，即，将相对灵活的M阶段的流表转换成能够被硬件所识别的Ⅳ阶段的流表．为了达到转换目的，FlowAdapter首先检查软件数据平面的全部规则，然后根据完整的规则将M阶段的流表转换成l阶段流表，最后再将1阶段流表转换成Ⅳ阶段流表发送给硬件数据平面．．另外，FlowAdapter相对控制器完全透明，对FlowAdapter交换机的更新不会影响控制器的正常运行．</p>
<p>与硬件设计交换机的观点不同，软件处理速度虽然低于硬件。但是软件方式可以最大限度提升规则灵活性。同时避免硬件受制于自身资源限制导致的流表大小受限，无法有效处理突发流的问题。同时软件也可以采用专用的NP(Network Processor)来替换CPU.</p>
<h3 id="转发规则的研究"><a href="#转发规则的研究" class="headerlink" title="转发规则的研究"></a>转发规则的研究</h3><p>如果网络节点失效，或者网络流量需要负载转移等情况，都会引发转发规则的变换。SDN采用高抽象层次的管理方式统一更新规则，防止出现规则更新不一致和规则延迟的现象。<br>一般采用两阶段提交方式更新规则[^40]：    第一阶段：规则需要更新，控制器询问每一个交换机是否处理完对应旧规则的流。并对处理完成的所有交换机进行规则更新。<br>第二阶段：当所有交换机都更新完毕后，才算完成更新，否则取消该更新操作。<br>这种方法需要等待旧规则的数据包处理完毕后才能处理新规则的数据包，会导致规则空间被占用的问题。这个时候可以采用增量式一致更新：，该算法将规则更新分成多轮进行每一轮都采用二阶段提交方式更新一个子集，这样可以节省规则空间，达到更新时间与规则空间的折中。</p>
<h2 id="控制层关键技术"><a href="#控制层关键技术" class="headerlink" title="控制层关键技术"></a>控制层关键技术</h2><p>控制器是控制层核心组件。通过控制器，用户可以逻辑上集中控制交换机，实现数据快速转发，安全便捷管理网络，提神网络整体性能。</p>
<h3 id="控制器设计问题"><a href="#控制器设计问题" class="headerlink" title="控制器设计问题"></a>控制器设计问题</h3><p>控制器基本功能是为科研人员提供可用的编程平台，最早且广泛使用的控制器平台是NOX。提供了一系列基本接口，用户通过NOX对全局网络信息进行获取，控制与管理。NOX的问题在于，随着SDN网络规模的扩展,单一结构集中控制的控制器处理能力受限，扩展困难，只能应用于小型企业网络或者科研人员进行仿真。网络中有两种方式扩展，第一是提升控制器性能，比如NOX-MT，第二种是采用多控制器方式提升整体控制器的能力。<br>NOX-MT是具有多线程处理能力的NOX控制器，NOX-MT不改变NOX控制器的基本结构，而是利用传统并行技术提升性能。<br>对于大规模网络，需要采用多控制器进行处理。分布式控制器有两种方式进行扩展，扁平控制方式和层次控制方式。．对于扁平控制方式（比如ONIX,HyperFlow），所有控制器被放置在不相交的区域里，分别管理各自的网络．各控制器间的地位相等，<br>并通过东西向接口进行通信．对于层次控制方式(Kandoo)，控制器之间具有垂直管理的功能．也就是说，局部控制器负责<br>各自的网络，全局控制器负责局部控制器，控制器之间的交互可通过全局控制器来完成．</p>
<p>SDN网络操作系统应该具有实时运行开发应用的能力，力求开发与执行的平衡。NOX采用Python或c++. 二者在开发效率和执行效率上各有偏重。科研人员致力于开发通用平台，Beacon就是一个基于Java的通用平台。它向用户提供了一系列相关的库与接口用于开发，并提供运行时模块化的功能，使其在保证性能的情况下具有了实时运行的能力，实现了开发与执行两者之间的平衡。</p>
<h3 id="接口语言"><a href="#接口语言" class="headerlink" title="接口语言"></a>接口语言</h3><p>传统的低级配置接口，比如用c++编写的接口，抽象程度低，不能大幅减少使用成本， 就有团队致力于开发网络配置语言,旨在搭建具有优化性能的通用北向接口。比如Nettle,McNettle(Nettle多核版)，采用了函数响应式编程（FPR）方式。Maple则对接口语言进一步抽象，允许用户使用自定义抽象策略。为了能够高效地将抽象策略分解成一系<br>列规则，并下发到相应的分布式交换机上，Maple不但采用了高效的多核调度器，最关键的是，它采用了跟踪运行时优化器(tracing runtime optimizer)来优化性能．该优化器一方面通过记录可重用的策略，将负载尽可能地转移<br>到交换机来处理．另一方面，通过动态跟踪抽象策略与数据内容及环境的依赖性，使流表始终处于最新状态，从而确保抽象策略转成可用规则的效率。  此外还介绍了Frenetic等。</p>
<h3 id="控制层特性研究"><a href="#控制层特性研究" class="headerlink" title="控制层特性研究"></a>控制层特性研究</h3><p>控制层存在一致性，可用性和容错性等特性，但是三种特性无法同时满足，达到三者之间的平衡和整体的最优化，是这个方向上的重点。</p>
<h4 id="一致性"><a href="#一致性" class="headerlink" title="一致性"></a>一致性</h4><p>集中控制是SDN区别于其他网络架构的核心优势之一，通过集中控制，用户可以获取全局网络视图，并根据全网信息对网络进行统一设计与部署，理论上保证了网络配置的一致性问题．然而，分布式控制器仍然具有潜在的不一致性问题．由于不同控制器的设计对网络一致性要求有所不同，严格保证分布式状态全局统一的控制器，将无法保证网络性能；反之，如果控制器能够快速响应请求，下发策略，则无法保证全局状态一致性．性能无明<br>显影响的情况下，保证状态一致性成为了SDN设计中的关键问题。<br>并发策略同样会导致一致性问题。可以由控制层将策略形成规则，并按两阶段提交方式解决．为了避免数据层过多的参与，控制层可直接通过并发策略组合的方式来解决，并可利用细粒度锁(fine—grained locking)确保组合策略无冲突发生．HFT采用了层次策略方案，它将并发策略分解，组织成树的形式，树的每个节点都可独立形成转发规则．HFT首先对每个节点进行自定义冲突处理操作，这样，整个冲突处理过程就转化成利用自定义冲突处理规则逆向搜索树的过程，从而解决了并发策略一致性问题．</p>
<h4 id="可用性"><a href="#可用性" class="headerlink" title="可用性"></a>可用性</h4><p>规则备份可以提升网络的可用性（RuleBrieks）。<br>控制器作为SDN的核心处理节点，需要处理来自交换机的大量请求，而过重的负载会影响SDN的可用性．利用分布式控制器可以平衡负载，提升SDN的整体性能．（ndoo，ElastiCon）.减少交换机的请求次数，可以提升控制层可用性。（DIFANE,DevoFlow）</p>
<h4 id="容错性"><a href="#容错性" class="headerlink" title="容错性"></a>容错性</h4><p>与传统的互联网类似，SDN同样面临着网络节点或链路失效的问题．然而，SDN控制器可以通过全网信息快速恢复失效节点，具有较强的容错能力．网络节点恢复收敛过程如图7所示：</p>
<ol>
<li>当某台交换机失效时，其他交换机察觉出变化；</li>
<li>交换机将变化情况通知控制器；</li>
<li>控制器根据所掌握的信息，计算出需要恢复的规则；</li>
<li>将更新发送给数据平面中受到影响的网络元素；</li>
<li>数据平面中受影响的元素分别更新流表信息．</li>
</ol>
<p>从链路恢复过程可以看出：在SDN架构中，失效信息一般不是通过洪泛方式通知全网，而是直接发送给控<br>制层，并由控制器来做恢复决策，因而不易出现路由振荡的现象．如果是交换机和控制器之间的链接失效，导致<br>无法通信，则收敛过程相对困难．可以采用传统网络的IGP(如OSPF协议)通信，并通过洪泛方式恢复，也可以采<br>用故障转移(failover)方式，同样能够缓解链路失效收敛时间问题．通过在交换机上安装用于验证拓扑连接性<br>的静态转发规则，可以更好地实现网络故障的快速收敛．<br>控制层也提供了一种高级容错语言FatTire.</p>
<h2 id="SDN应用研究"><a href="#SDN应用研究" class="headerlink" title="SDN应用研究"></a>SDN应用研究</h2><h3 id="企业与校园网"><a href="#企业与校园网" class="headerlink" title="企业与校园网"></a>企业与校园网</h3><p>早期SDN研究主要场景。在第二代中国教育和科研计算机网中，利用4over6技术和SDN网络虚拟化思想进行v4到v6的过渡。</p>
<h3 id="数据中心与云"><a href="#数据中心与云" class="headerlink" title="数据中心与云"></a>数据中心与云</h3><p>数据中心需求带宽高，设备繁多，高度集中，在此部署SDN也有严峻的考验。早期的实例是基于NOX的SDN网络。在合理运用带宽方面的实践有OpenFlow,DevoFlow,zUpdate等。在节能方面，利用SDN掌控全局，实时关闭不必要的设备以进行节能，能够节省约一半的能耗。同时也能进行负载均衡，避免资源浪费。</p>
<h3 id="广域网"><a href="#广域网" class="headerlink" title="广域网"></a>广域网</h3><p>Google B4系统，微软SWAN系统，都基于SDN架构，大幅提升了链路利用率。其中SWAN系统主要基于传统设备，利于普及和升级。</p>
<h3 id="无线网络"><a href="#无线网络" class="headerlink" title="无线网络"></a>无线网络</h3><p>OpenRoads, Odin,OpenRadio,SoftRAN等。</p>
<h2 id="SDN未来方向"><a href="#SDN未来方向" class="headerlink" title="SDN未来方向"></a>SDN未来方向</h2><h3 id="SDN可扩展性研究"><a href="#SDN可扩展性研究" class="headerlink" title="SDN可扩展性研究"></a>SDN可扩展性研究</h3><h3 id="SDN规模部署和跨域通信"><a href="#SDN规模部署和跨域通信" class="headerlink" title="SDN规模部署和跨域通信"></a>SDN规模部署和跨域通信</h3><h3 id="传统网络与SDN共存问题研究"><a href="#传统网络与SDN共存问题研究" class="headerlink" title="传统网络与SDN共存问题研究"></a>传统网络与SDN共存问题研究</h3><h3 id="SDN在数据中心的应用研究"><a href="#SDN在数据中心的应用研究" class="headerlink" title="SDN在数据中心的应用研究"></a>SDN在数据中心的应用研究</h3><h3 id="借鉴SDN思想融合IPv6过渡机制"><a href="#借鉴SDN思想融合IPv6过渡机制" class="headerlink" title="借鉴SDN思想融合IPv6过渡机制"></a>借鉴SDN思想融合IPv6过渡机制</h3><h3 id="SDN与其他新型网络架构融合"><a href="#SDN与其他新型网络架构融合" class="headerlink" title="SDN与其他新型网络架构融合"></a>SDN与其他新型网络架构融合</h3><h3 id="SDN网络安全"><a href="#SDN网络安全" class="headerlink" title="SDN网络安全"></a>SDN网络安全</h3><p><a href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:MD-SAL:Component_Map" rel="external nofollow noopener noreferrer" target="_blank">控制器mdsal组件列表</a><br><a href="https://nexus.opendaylight.org/content/sites/site/org.opendaylight.mdsal/beryllium/apidocs/" rel="external nofollow noopener noreferrer" target="_blank">ODL beryllium版本API，已过期</a><br><a href="https://nexus.opendaylight.org/content/sites/site/org.opendaylight.mdsal/boron/apidocs/" rel="external nofollow noopener noreferrer" target="_blank">ODL boron版本API，目前最新(1/6/2017)</a><br><a href="https://git.opendaylight.org/gerrit/#/admin/projects/" rel="external nofollow noopener noreferrer" target="_blank">官方Git</a>  </p>
<hr>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p><a href="http://www.muzixing.com/pages/2015/08/30/sdnkong-zhi-ping-mian-fa-zhan-li-shi-ji-qu-shi.html" rel="external nofollow noopener noreferrer" target="_blank">sdn架构</a><br><a href="http://blog.csdn.net/yuzhihui_no1/article/details/39161515" rel="external nofollow noopener noreferrer" target="_blank">ovs模块划分</a><br><a href="http://blog.csdn.net/yuzhihui_no1/article/details/41546481" rel="external nofollow noopener noreferrer" target="_blank">ovs源码分析系列</a><br><a href="https://wiki.opendaylight.org/view/Network_Intent_Composition:Use_Cases#Suspicious_DDoS_activity_monitoring" rel="external nofollow noopener noreferrer" target="_blank">ODL用户邮件(感觉有用，但是不知道怎么用)</a><br><a href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:Load_Balancer_Service" rel="external nofollow noopener noreferrer" target="_blank">ODL 负载均衡演示(已过期)</a><br><a href="http://docs.opendaylight.org/en/stable-boron/getting-started-guide/security_considerations.html" rel="external nofollow noopener noreferrer" target="_blank">ODL安全措施，没啥用</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">SDN</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/SDN_conclusion.html">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-Smarking Algorithm Contest 3" class="article article-type-post  article-index" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Smarking Algorithm Contest 3.html">Smarking Algorithm Contest 3</a>
    </h1>
  

        
        <a href="/Smarking Algorithm Contest 3.html" class="archive-article-date">
  	<time datetime="2016-11-06T06:37:31.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-11-06</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-453-Minimum-Moves-to-Equal-Array-Elements"><a href="#1-453-Minimum-Moves-to-Equal-Array-Elements" class="headerlink" title="1.  453. Minimum Moves to Equal Array Elements"></a>1.  453. Minimum Moves to Equal Array Elements</h2><p>Given a <strong>non-empty</strong> integer array of size n, find the minimum number of moves required to make all array elements equal, where a move is incrementing n - 1 elements by 1.<br>Ex:<br><figure class="highlight inform7"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Input:</div><div class="line"><span class="comment">[1,2,3]</span></div><div class="line"></div><div class="line">Output:</div><div class="line">3</div><div class="line"></div><div class="line">Explanation:</div><div class="line">Only three moves <span class="keyword">are</span> needed (remember each move increments two elements):</div><div class="line"></div><div class="line"><span class="comment">[1,2,3]</span>  =&gt;  <span class="comment">[2,3,3]</span>  =&gt;  <span class="comment">[3,4,3]</span>  =&gt;  <span class="comment">[4,4,4]</span></div></pre></td></tr></table></figure></p>
<p>给一个长度为n的非空数组，将这个数组中的其中n-1个元素都+1，称为一次操作。求出将这个数组所有元素都变为相同大小的操作的次数。<br>解法：<br><figure class="highlight fortran"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">func minMoves(nums []<span class="built_in">int</span>) <span class="built_in">int</span> &#123;</div><div class="line">	<span class="keyword">if</span> len(nums) &lt;= <span class="number">1</span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span></div><div class="line">	&#125;</div><div class="line">	<span class="built_in">sum</span>,<span class="built_in">min</span>,<span class="built_in">max</span> := nums[<span class="number">0</span>],nums[<span class="number">0</span>],nums[<span class="number">0</span>]</div><div class="line">	for i:=<span class="number">1</span>;i&lt;len(nums);i++&#123;</div><div class="line">		<span class="built_in">sum</span> += nums[i]</div><div class="line">		<span class="keyword">if</span> <span class="built_in">min</span> &gt; nums[i]&#123;</div><div class="line">			<span class="built_in">min</span> = nums[i]</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> <span class="built_in">max</span> &lt; nums[i]&#123;</div><div class="line">			<span class="built_in">max</span> = nums[i]</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="built_in">sum</span> - len(nums)*<span class="built_in">min</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="2-447-Number-of-Boomerangs"><a href="#2-447-Number-of-Boomerangs" class="headerlink" title="2. 447. Number of Boomerangs"></a>2. 447. Number of Boomerangs</h2><p>Given n points in the plane that are all pairwise distinct, a “boomerang” is a tuple of points (i, j, k) such that the distance between i and j equals the distance between i and k (the order of the tuple matters).</p>
<p>Find the number of boomerangs. You may assume that n will be at most 500 and coordinates of points are all in the range [-10000, 10000] (inclusive).<br>Ex:<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Input:</div><div class="line"><span class="string">[[0,0],[1,0],[2,0]]</span></div><div class="line"></div><div class="line">Output:</div><div class="line"><span class="number">2</span></div><div class="line"></div><div class="line">Explanation:</div><div class="line">The two boomerangs are <span class="string">[[1,0],[0,0],[2,0]]</span> <span class="keyword">and</span> <span class="string">[[1,0],[2,0],[0,0]]</span></div></pre></td></tr></table></figure></p>
<p>给定平面内的坐标。求出这些坐标中，一个点到另外两个点距离相同的组合。<br>这题只要求出每个坐标到其他坐标的距离。然后再遍历就行了。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">pow</span><span class="params">(t <span class="keyword">int</span>)</span> <span class="title">int</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> t*t</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">numberOfBoomerangs</span><span class="params">(points [][]<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</div><div class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(points) &lt;<span class="number">3</span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span></div><div class="line">	&#125;</div><div class="line">	dis := <span class="built_in">make</span>([][]<span class="keyword">int</span>,<span class="built_in">len</span>(points))</div><div class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="built_in">len</span>(points);i++&#123;</div><div class="line">		dis[i] = <span class="built_in">make</span>([]<span class="keyword">int</span>,<span class="built_in">len</span>(points))</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="built_in">len</span>(points);i++&#123;</div><div class="line">		<span class="keyword">for</span> j:=i+<span class="number">1</span>;j&lt;<span class="built_in">len</span>(points);j++&#123;</div><div class="line">			t := pow(points[i][<span class="number">0</span>] - points[j][<span class="number">0</span>])+pow(points[i][<span class="number">1</span>] - points[j][<span class="number">1</span>])</div><div class="line">			dis[i][j],dis[j][i] = t,t</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	count := <span class="number">0</span></div><div class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="built_in">len</span>(points);i++&#123;</div><div class="line">		<span class="keyword">for</span> j:=<span class="number">0</span>;j&lt;<span class="built_in">len</span>(points);j++&#123;</div><div class="line">			<span class="keyword">if</span> j == i&#123;</div><div class="line">				<span class="keyword">continue</span></div><div class="line">			&#125;</div><div class="line">			<span class="keyword">for</span> k := j+<span class="number">1</span>;k&lt;<span class="built_in">len</span>(points);k++&#123;</div><div class="line">				<span class="keyword">if</span> dis[i][j] == dis[i][k]&#123;</div><div class="line">					count +=<span class="number">2</span></div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> count</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="3-452-Minimum-Number-of-Arrows-to-Burst-Balloons"><a href="#3-452-Minimum-Number-of-Arrows-to-Burst-Balloons" class="headerlink" title="3. 452. Minimum Number of Arrows to Burst Balloons"></a>3. 452. Minimum Number of Arrows to Burst Balloons</h2><p>There are a number of spherical balloons spread in two-dimensional space. For each balloon, provided input is the start and end coordinates of the horizontal diameter. Since it’s horizontal, y-coordinates don’t matter and hence the x-coordinates of start and end of the diameter suffice. Start is always smaller than end. There will be at most 104 balloons.</p>
<p>An arrow can be shot up exactly vertically from different points along the x-axis. A balloon with xstart and xend bursts by an arrow shot at x if xstart ≤ x ≤ xend. There is no limit to the number of arrows that can be shot. An arrow once shot keeps travelling up infinitely. The problem is to find the minimum number of arrows that must be shot to burst all balloons.<br>Ex:<br><figure class="highlight inform7"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Input:</div><div class="line"><span class="comment">[<span class="comment">[10,16]</span>, <span class="comment">[2,8]</span>, <span class="comment">[1,6]</span>, <span class="comment">[7,12]</span>]</span></div><div class="line"></div><div class="line">Output:</div><div class="line">2</div><div class="line"></div><div class="line">Explanation:</div><div class="line">One way <span class="keyword">is</span> to shoot one arrow for example at x = 6 (bursting the balloons <span class="comment">[2,8]</span> and <span class="comment">[1,6]</span>) and another arrow at x = 11 (bursting the other two balloons).</div></pre></td></tr></table></figure></p>
<p>这题把一堆乱七八糟的背景剥开后，题目实际上是这样的：<br>给定一组区间，然后要你给出长度最小的一组数，这组数中所有的点都在区间内而且没有区间被遗漏。<br>用贪心算法就可以做。将区间按起点从小到大排列。<br>然后每一次都选一个点，能够尽量的覆盖到最多的区间。直到不能覆盖为止。依次取点，直到区间都有点落在上面。<br><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> ranges [][]<span class="keyword">int</span> </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span><span class="params">(r ranges)</span><span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(r)</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span><span class="params">(r  ranges)</span><span class="title">Less</span><span class="params">(i,j <span class="keyword">int</span>)</span><span class="title">bool</span></span>&#123;</div><div class="line">	<span class="keyword">if</span> r[i][<span class="number">0</span>] != r[j][<span class="number">0</span>]&#123;</div><div class="line">		<span class="keyword">return</span> r[i][<span class="number">0</span>]&lt;r[j][<span class="number">0</span>]</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> r[i][<span class="number">1</span>]&lt;r[j][<span class="number">1</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r  ranges)</span><span class="title">Swap</span><span class="params">(i,j <span class="keyword">int</span>)</span></span>&#123;</div><div class="line">	r[i][<span class="number">0</span>],r[j][<span class="number">0</span>] = r[j][<span class="number">0</span>],r[i][<span class="number">0</span>]</div><div class="line">	r[j][<span class="number">1</span>],r[i][<span class="number">1</span>] = r[i][<span class="number">1</span>],r[j][<span class="number">1</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">findMinArrowShots</span><span class="params">(points [][]<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</div><div class="line">	p := ranges(points)</div><div class="line">	sort.Sort(p)</div><div class="line">	count := <span class="number">0</span></div><div class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="built_in">len</span>(p);i++&#123;</div><div class="line">		count ++</div><div class="line">		j := i+<span class="number">1</span></div><div class="line">		at := p[i][<span class="number">1</span>]</div><div class="line">		<span class="keyword">for</span> j = i+<span class="number">1</span>;j&lt;<span class="built_in">len</span>(p) ;j++&#123;</div><div class="line">			<span class="keyword">if</span> p[j][<span class="number">0</span>]&gt;at&#123;</div><div class="line">				i = j<span class="number">-1</span></div><div class="line">				<span class="keyword">break</span></div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> p[j][<span class="number">1</span>] &lt; at&#123;</div><div class="line">				at = p[j][<span class="number">1</span>]</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> j == <span class="built_in">len</span>(p)&#123;</div><div class="line">			<span class="keyword">break</span></div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> count</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="4-446-Arithmetic-Slices-II-Subsequence"><a href="#4-446-Arithmetic-Slices-II-Subsequence" class="headerlink" title="4. 446. Arithmetic Slices II - Subsequence"></a>4. 446. Arithmetic Slices II - Subsequence</h2><p>A zero-indexed array A consisting of N numbers is given. A subsequence slice of that array is any sequence of integers (P0, P1, …, Pk) such that 0 ≤ P0 &lt; P1 &lt; … &lt; Pk &lt; N.</p>
<p>A subsequence slice (P0, P1, …, Pk) of array A is called arithmetic if the sequence A[P0], A[P1], …, A[Pk-1], A[Pk] is arithmetic. In particular, this means that k ≥ 2.</p>
<p>The function should return the number of arithmetic subsequence slices in the array A.</p>
<p>Ex:<br><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">Input</span>: [2, 4, 6, 8, 10]</div><div class="line"></div><div class="line"><span class="http"><span class="attribute">Output</span>: 7</span></div><div class="line"></div><div class="line"><span class="inform7">Explanation:</span></div><div class="line">All arithmetic subsequence slices <span class="keyword">are</span>:</div><div class="line"><span class="comment">[2,4,6]</span></div><div class="line"><span class="comment">[4,6,8]</span></div><div class="line"><span class="comment">[6,8,10]</span></div><div class="line"><span class="comment">[2,4,6,8]</span></div><div class="line"><span class="comment">[4,6,8,10]</span></div><div class="line"><span class="comment">[2,4,6,8,10]</span></div><div class="line"><span class="comment">[2,6,10]</span></div></pre></td></tr></table></figure></p>
<p>这题试了下DFS会超时，用DP做会MLE。最后没做出来。<br>给个别人的代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">numberOfArithmeticSlices</span><span class="params">(self, A)</span>:</span></div><div class="line">		<span class="string">"""</span></div><div class="line">		:type A: List[int]</div><div class="line">		:rtype: int</div><div class="line">		"""</div><div class="line">		ans=<span class="number">0</span></div><div class="line">		dp = []</div><div class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(len(A)):</div><div class="line">			a=A[i]</div><div class="line">			dp.append(&#123;&#125;)</div><div class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> range(i):</div><div class="line">				b=A[j]</div><div class="line">				d=a-b</div><div class="line">				<span class="keyword">if</span> d <span class="keyword">in</span> dp[j]:</div><div class="line">					v=<span class="number">1</span>+dp[j][d]</div><div class="line">				<span class="keyword">else</span>:</div><div class="line">					v=<span class="number">1</span></div><div class="line">				<span class="keyword">if</span> d <span class="keyword">in</span> dp[i]:</div><div class="line">					dp[i][d]=dp[i][d]+v</div><div class="line">				<span class="keyword">else</span>:</div><div class="line">					dp[i][d]=v</div><div class="line">			ans += sum([dp[i][x] <span class="keyword">for</span> x <span class="keyword">in</span> dp[i]]) - i</div><div class="line">		<span class="keyword">return</span> ans</div></pre></td></tr></table></figure></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">Leetcode</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">Golang</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/Smarking Algorithm Contest 3.html">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-Smarking Algorithm Contest 2" class="article article-type-post  article-index" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Smarking Algorithm Contest 2.html">Smarking Algorithm Contest 2</a>
    </h1>
  

        
        <a href="/Smarking Algorithm Contest 2.html" class="archive-article-date">
  	<time datetime="2016-10-30T04:21:31.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-10-30</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="435-Non-overlapping-Intervals"><a href="#435-Non-overlapping-Intervals" class="headerlink" title="435. Non-overlapping Intervals"></a>435. Non-overlapping Intervals</h2><p>Given a collection of intervals, find the minimum number of intervals you need to remove to make the rest of the intervals non-overlapping.</p>
<p>Note:</p>
<ol>
<li>You may assume the interval’s end point is always bigger than its start point.</li>
<li>Intervals like [1,2] and [2,3] have borders “touching” but they don’t overlap each other.</li>
</ol>
<p>给定一组区间，你可以移除一些区间让这组区间互不重叠。</p>
<p>做法是：</p>
<ol>
<li>首先将区间按照起点大小排序。</li>
<li>将区间中所有完全覆盖其他区间的区间移除掉。</li>
<li>在剩下的区间中，如果有区间，和它之前的区间有重叠，就移除它。</li>
</ol>
<p>代码如下：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> arrI []Interval</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a arrI)</span><span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(a)</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a arrI)</span><span class="title">Less</span><span class="params">(i,j <span class="keyword">int</span>)</span> <span class="title">bool</span></span>&#123;</div><div class="line">	<span class="keyword">if</span> a[i].Start!=a[j].Start&#123;</div><div class="line">		<span class="keyword">return</span> a[i].Start&lt;a[j].Start</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> a[i].End&gt;=a[j].End</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a arrI)</span><span class="title">Swap</span><span class="params">(i,j <span class="keyword">int</span>)</span></span>&#123;</div><div class="line">	a[i],a[j] = a[j],a[i]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">eraseOverlapIntervals</span><span class="params">(intervals []Interval)</span> <span class="title">int</span></span> &#123;</div><div class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(intervals) &lt;= <span class="number">1</span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span></div><div class="line">	&#125;</div><div class="line">	tmp := arrI(intervals)</div><div class="line">    sort.Sort(tmp)</div><div class="line">	res := tmp[<span class="number">0</span>]</div><div class="line">	count :=<span class="number">0</span></div><div class="line">	ret := []Interval&#123;&#125;</div><div class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="built_in">len</span>(tmp);i++&#123;</div><div class="line">		flag := <span class="literal">false</span></div><div class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(ret)&gt;<span class="number">0</span> &amp;&amp; tmp[i].Start &lt;=  ret[<span class="built_in">len</span>(ret)<span class="number">-1</span>].Start&#123;</div><div class="line">			flag = <span class="literal">true</span></div><div class="line">			count ++</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			<span class="keyword">for</span> j:=i+<span class="number">1</span>;j&lt;<span class="built_in">len</span>(tmp);j++&#123;</div><div class="line">				<span class="keyword">if</span> tmp[i].End &lt;= tmp[j].Start&#123;</div><div class="line">					<span class="keyword">break</span></div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span> tmp[i].End &gt;= tmp[j].End&#123;</div><div class="line">					flag = <span class="literal">true</span></div><div class="line">					count ++</div><div class="line">					<span class="keyword">break</span></div><div class="line">				&#125;</div><div class="line">				</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> !flag&#123;</div><div class="line">			ret = <span class="built_in">append</span>(ret,tmp[i])</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(ret) == <span class="number">0</span>&#123;</div><div class="line">		<span class="keyword">return</span> count</div><div class="line">	&#125;</div><div class="line">	res =ret[<span class="number">0</span>]</div><div class="line">	<span class="keyword">for</span> i:=<span class="number">1</span>;i&lt;<span class="built_in">len</span>(ret);i++&#123;</div><div class="line">		<span class="keyword">if</span> ret[i].Start &gt;= res.End&#123;</div><div class="line">			res = ret[i]</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			count ++</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> count</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="436-Find-Right-Interval"><a href="#436-Find-Right-Interval" class="headerlink" title="436. Find Right Interval"></a>436. Find Right Interval</h2><p>Given a set of intervals, for each of the interval i, check if there exists an interval j whose start point is bigger than or equal to the end point of the interval i, which can be called that j is on the “right” of i.</p>
<p>For any interval i, you need to store the minimum interval j’s index, which means that the interval j has the minimum start point to build the “right” relationship for interval i. If the interval j doesn’t exist, store -1 for the interval i. Finally, you need output the stored value of each interval as an array.</p>
<p>Note:</p>
<ol>
<li>You may assume the interval’s end point is always bigger than its start point.</li>
<li>You may assume none of these intervals have the same start point.<br>给定一组区间，对于每一个区间，如果有其他区间的起点大于等于这个区间的终点，那么就称这个区间有右区间。找出最近的右区间的下标。没有右区间则该区间的最小右区间为-1。</li>
</ol>
<p>这题直接用o(n*n)的算法就能过。即一个个找右区间。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">findRightInterval</span><span class="params">(intervals []Interval)</span> []<span class="title">int</span></span> &#123;</div><div class="line">    ret := <span class="built_in">make</span>([]<span class="keyword">int</span>,<span class="built_in">len</span>(intervals))</div><div class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="built_in">len</span>(intervals);i++&#123;</div><div class="line">		min := i</div><div class="line">		<span class="keyword">for</span> j:=<span class="number">0</span>;j&lt;<span class="built_in">len</span>(intervals);j++&#123;</div><div class="line">			<span class="keyword">if</span> j == i&#123;</div><div class="line">				<span class="keyword">continue</span></div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> intervals[j].Start &gt;= intervals[i].End&#123;</div><div class="line">				<span class="keyword">if</span> min == i || intervals[j].Start &lt; intervals[min].Start&#123;</div><div class="line">					 min = j</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> min == i&#123;</div><div class="line">			min = <span class="number">-1</span></div><div class="line">		&#125;</div><div class="line">		ret[i] = min</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ret</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="441-Arranging-Coins"><a href="#441-Arranging-Coins" class="headerlink" title="441. Arranging Coins"></a>441. Arranging Coins</h2><p>You have a total of n coins that you want to form in a staircase shape, where every k-th row must have exactly k coins.</p>
<p>Given n, find the total number of full staircase rows that can be formed.</p>
<p>n is a non-negative integer and fits within the range of a 32-bit signed integer.</p>
<p>水题，没啥好说的。<br><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">arrangeCoins</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</div><div class="line">    idx  :=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (n&gt;=idx)&#123;</div><div class="line">		n -=idx</div><div class="line">		idx ++</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> idx<span class="number">-1</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="444-Sequence-Reconstruction"><a href="#444-Sequence-Reconstruction" class="headerlink" title="444. Sequence Reconstruction"></a>444. Sequence Reconstruction</h2><p>Check whether the original sequence org can be uniquely reconstructed from the sequences in seqs. The org sequence is a permutation of the integers from 1 to n, with 1 ≤ n ≤ 10^4. Reconstruction means building a shortest common supersequence of the sequences in seqs (i.e., a shortest sequence so that all sequences in seqs are subsequences of it). Determine whether there is only one sequence that can be reconstructed from seqs and it is the org sequence.</p>
<p><a href="https://leetcode.com/contest/11/problems/sequence-reconstruction/" rel="external nofollow noopener noreferrer" target="_blank">link</a><br>没做出来，贴个别人的代码。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">sequenceReconstruction</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; org, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; seqs)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = org.size();</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; to(n), in(n);</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt; vis(n);</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; adj(n);</div><div class="line">        <span class="keyword">int</span> k = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : org) &#123;</div><div class="line">            x--;</div><div class="line">            to[x] = k++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;vec : seqs) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;c : vec) &#123;</div><div class="line">                c--;</div><div class="line">                <span class="keyword">if</span> (c &lt; <span class="number">0</span> || c &gt;= n) &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">                &#125;</div><div class="line">                vis[to[c]] = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; vec.size(); i++) &#123;</div><div class="line">                <span class="keyword">auto</span> x = to[vec[i - <span class="number">1</span>]], y = to[vec[i]];</div><div class="line">                adj[x].push_back(y);</div><div class="line">                in[y]++;</div><div class="line">                <span class="keyword">if</span> (x &gt; y) &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (!vis[i]) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (!in[i]) &#123;</div><div class="line">                q.push(i);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; sorted;</div><div class="line">        <span class="keyword">while</span> (!q.empty()) &#123;</div><div class="line">            <span class="keyword">if</span> (q.size() &gt; <span class="number">1</span>) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">auto</span> s = q.front();</div><div class="line">            q.pop();</div><div class="line">            sorted.push_back(s);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> v : adj[s]) &#123;</div><div class="line">                <span class="keyword">if</span> (!--in[v]) &#123;</div><div class="line">                    q.push(v);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (i != sorted[i]) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">Leetcode</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">Golang</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/Smarking Algorithm Contest 2.html">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-leetcode_weekly_contest10" class="article article-type-post  article-index" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/leetcode_weekly_contest10.html">Leetcode第十周周赛Smarking Algorithm Contest</a>
    </h1>
  

        
        <a href="/leetcode_weekly_contest10.html" class="archive-article-date">
  	<time datetime="2016-10-23T06:37:31.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-10-23</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="437-Path-Sum-III"><a href="#437-Path-Sum-III" class="headerlink" title="437. Path Sum III"></a>437. Path Sum III</h2><p>You are given a binary tree in which each node contains an integer value.</p>
<p>Find the number of paths that sum to a given value.</p>
<p>The path does not need to start or end at the root or a leaf, but it must go downwards (traveling only from parent nodes to child nodes).</p>
<p>The tree has no more than 1,000 nodes and the values are in the range -1,000,000 to 1,000,000.<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">root = [<span class="number">10</span>,<span class="number">5</span>,-<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="literal">null</span>,<span class="number">11</span>,<span class="number">3</span>,-<span class="number">2</span>,<span class="literal">null</span>,<span class="number">1</span>], sum = <span class="number">8</span></div><div class="line"></div><div class="line">      <span class="number">10</span></div><div class="line">     /  <span class="string">\</span></div><div class="line">    <span class="number">5</span>   -<span class="number">3</span></div><div class="line">   / <span class="string">\</span>    <span class="string">\</span></div><div class="line">  <span class="number">3</span>   <span class="number">2</span>   <span class="number">11</span></div><div class="line"> / <span class="string">\</span>   <span class="string">\</span></div><div class="line"><span class="number">3</span>  -<span class="number">2</span>   <span class="number">1</span></div><div class="line"></div><div class="line">Return <span class="number">3.</span> The paths <span class="literal">that</span> sum <span class="keyword">to</span> <span class="number">8</span> are:</div><div class="line"></div><div class="line"><span class="number">1.</span>  <span class="number">5</span><span class="function"> -&gt;</span> <span class="number">3</span></div><div class="line"><span class="number">2.</span>  <span class="number">5</span><span class="function"> -&gt;</span> <span class="number">2</span><span class="function"> -&gt;</span> <span class="number">1</span></div><div class="line"><span class="number">3.</span> -<span class="number">3</span><span class="function"> -&gt;</span> <span class="number">11</span></div></pre></td></tr></table></figure></p>
<p>给你个树，求出所有符合路径上的节点的值的和等于给定值这个条件的路径的个数。路径要求是自上而下，但是不要求从根出发，也不要求以叶子节点作为结尾。<br>挂在这道题上面了。<br>给个别人的解法：<br>将路径分为两种走法，每个节点都有两种走法。第一种情况是以这个节点为起点，开始出发。第二种是继承之前的走法接着走下去。<br><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> res <span class="keyword">int</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">go2</span><span class="params">(root *TreeNode, need <span class="keyword">int</span>)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span> root == <span class="literal">nil</span>&#123;</div><div class="line">		<span class="keyword">return</span></div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> need == <span class="number">0</span>&#123;</div><div class="line">		res ++</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> root.Left != <span class="literal">nil</span>&#123;</div><div class="line">		go2(root.Left,need-root.Left.Val)</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> root.Right != <span class="literal">nil</span>&#123;</div><div class="line">		go2(root.Right,need-root.Right.Val)</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">go1</span><span class="params">(root * TreeNode, need <span class="keyword">int</span>)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span> root == <span class="literal">nil</span>&#123;</div><div class="line">		<span class="keyword">return</span></div><div class="line">	&#125;</div><div class="line">	go2(root,need-root.Val)</div><div class="line">	go1(root.Left,need)</div><div class="line">	go1(root.Right,need)</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">pathSum</span><span class="params">(root *TreeNode, sum <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</div><div class="line">	res = <span class="number">0</span></div><div class="line">	go1(root, sum)</div><div class="line">	<span class="keyword">return</span> res</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="438-Find-All-Anagrams-in-a-String"><a href="#438-Find-All-Anagrams-in-a-String" class="headerlink" title="438. Find All Anagrams in a String"></a>438. Find All Anagrams in a String</h2><p>Given a string s and a non-empty string p, find all the start indices of p’s anagrams in s.</p>
<p>Strings consists of lowercase English letters only and the length of both strings s and p will not be larger than 20,100.</p>
<p>The order of output does not matter.<br>Example 1:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Input:</div><div class="line">s: "cbaebabacd" p: "abc"</div><div class="line"></div><div class="line">Output:</div><div class="line">[0, 6]</div><div class="line"></div><div class="line">Explanation:</div><div class="line">The substring with <span class="keyword">start</span> <span class="keyword">index</span> = <span class="number">0</span> <span class="keyword">is</span> <span class="string">"cba"</span>, which <span class="keyword">is</span> an anagram <span class="keyword">of</span> <span class="string">"abc"</span>.</div><div class="line">The <span class="keyword">substring</span> <span class="keyword">with</span> <span class="keyword">start</span> <span class="keyword">index</span> = <span class="number">6</span> <span class="keyword">is</span> <span class="string">"bac"</span>, which <span class="keyword">is</span> an anagram <span class="keyword">of</span> <span class="string">"abc"</span>.</div></pre></td></tr></table></figure></p>
<p>Example 2:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Input:</div><div class="line">s: "abab" p: "ab"</div><div class="line"></div><div class="line">Output:</div><div class="line">[0, 1, 2]</div><div class="line"></div><div class="line">Explanation:</div><div class="line">The substring with <span class="keyword">start</span> <span class="keyword">index</span> = <span class="number">0</span> <span class="keyword">is</span> <span class="string">"ab"</span>, which <span class="keyword">is</span> an anagram <span class="keyword">of</span> <span class="string">"ab"</span>.</div><div class="line">The <span class="keyword">substring</span> <span class="keyword">with</span> <span class="keyword">start</span> <span class="keyword">index</span> = <span class="number">1</span> <span class="keyword">is</span> <span class="string">"ba"</span>, which <span class="keyword">is</span> an anagram <span class="keyword">of</span> <span class="string">"ab"</span>.</div><div class="line">The <span class="keyword">substring</span> <span class="keyword">with</span> <span class="keyword">start</span> <span class="keyword">index</span> = <span class="number">2</span> <span class="keyword">is</span> <span class="string">"ab"</span>, which <span class="keyword">is</span> an anagram <span class="keyword">of</span> <span class="string">"ab"</span>.</div></pre></td></tr></table></figure></p>
<p>给定两个字符串s,p，求出p的所有变形（包括自己）在s中的起点。<br>解法是统计p中的词频，然后统计s中i到<code>i+len(p)</code>中的字符串的词频。相比较，如果相等则说明命中了。<br><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">check</span><span class="params">(a,b,c [26]<span class="keyword">int</span>)</span> <span class="title">bool</span></span>&#123;</div><div class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++&#123;</div><div class="line">		<span class="keyword">if</span> a[i]-b[i] != c[i]&#123;</div><div class="line">			<span class="keyword">return</span> <span class="literal">false</span></div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="literal">true</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">findAnagrams</span><span class="params">(s <span class="keyword">string</span>, p <span class="keyword">string</span>)</span> []<span class="title">int</span></span> &#123;</div><div class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(s)&lt;<span class="built_in">len</span>(p)&#123;</div><div class="line">		<span class="keyword">return</span> []<span class="keyword">int</span>&#123;&#125;</div><div class="line">	&#125;</div><div class="line">	ret := []<span class="keyword">int</span>&#123;&#125;</div><div class="line">    start, end, mark := [<span class="number">26</span>]<span class="keyword">int</span>&#123;&#125;,[<span class="number">26</span>]<span class="keyword">int</span>&#123;&#125;,[<span class="number">26</span>]<span class="keyword">int</span>&#123;&#125;</div><div class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="built_in">len</span>(p);i++&#123;</div><div class="line">		mark[p[i]-<span class="string">'a'</span>] ++</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="built_in">len</span>(p);i++&#123;</div><div class="line">		end[s[i]-<span class="string">'a'</span>] ++</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> check(end,start,mark)&#123;</div><div class="line">		ret = <span class="built_in">append</span>(ret,<span class="number">0</span>)</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span> i:=<span class="built_in">len</span>(p);i&lt;<span class="built_in">len</span>(s);i++&#123;</div><div class="line">		start[s[i-<span class="built_in">len</span>(p)]-<span class="string">'a'</span>] ++</div><div class="line">		end[s[i]-<span class="string">'a'</span>]++</div><div class="line">		<span class="keyword">if</span> check(end,start,mark)&#123;</div><div class="line">			ret = <span class="built_in">append</span>(ret,i-<span class="built_in">len</span>(p)+<span class="number">1</span>)</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ret</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="439-Ternary-Expression-Parser"><a href="#439-Ternary-Expression-Parser" class="headerlink" title="439. Ternary Expression Parser"></a>439. Ternary Expression Parser</h2><p>Given a string representing arbitrarily nested ternary expressions, calculate the result of the expression. You can always assume that the given expression is valid and only consists of digits 0-9, ?, :, T and F (T and F represent True and False respectively).</p>
<p>Note:</p>
<ol>
<li>The length of the given string is ≤ 10000.</li>
<li>Each number will contain only one digit.</li>
<li>The conditional expressions group right-to-left (as usual in most languages).</li>
<li>The condition will always be either T or F. That is, the condition will never be a digit.</li>
<li>The result of the expression will always evaluate to either a digit 0-9, T or F.<br>Example 1:<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Input: <span class="string">"T?2:3"</span></div><div class="line">Output: <span class="string">"2"</span></div><div class="line">Explanation: If <span class="literal">true</span>, <span class="keyword">then</span> <span class="literal">result</span> <span class="keyword">is</span> <span class="number">2</span>; otherwise <span class="literal">result</span> <span class="keyword">is</span> <span class="number">3.</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>Example 2:<br><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">Input</span>: "F?1:T?4:5"</div><div class="line"><span class="attribute">Output</span>: "4"</div><div class="line"><span class="attribute">Explanation</span>: The conditional expressions group right-to-left. Using parenthesis, it is read/evaluated as:</div><div class="line"></div><div class="line"><span class="clean"></span></div><div class="line">             <span class="string">"(F ? 1 : (T ? 4 : 5))"</span>                   <span class="string">"(F ? 1 : (T ? 4 : 5))"</span></div><div class="line">          -&gt; <span class="string">"(F ? 1 : 4)"</span>                 or       -&gt; <span class="string">"(T ? 4 : 5)"</span></div><div class="line">          -&gt; <span class="string">"4"</span>                                    -&gt; <span class="string">"4"</span></div><div class="line">```   </div><div class="line"></div><div class="line"></div><div class="line">就是C语言中常见的`?:`语句。</div><div class="line">这题可以利用栈来做，也可以利用递归来做，应该也可以用正则表达式来做。</div><div class="line">下面是递归的做法：</div></pre></td></tr></table></figure></p>
<p>func parseTernary(e string) string {<br>    if e[0] != ‘T’ &amp;&amp; e[0]!=’F’{<br>        return e<br>    }<br>    c1,c2,i := 0,0,1<br>    for i=1;i<len(e);i++{ if="" e[i]="=" '?'{="" c1="" ++="" }else{="" ':'{="" c2="" c2{="" break;="" }="" i="=" len(e){="" return="" e="" e[0]="=" 't'{="" parseternary(e[2:i])="" parseternary(e[i+1:])="" <figure="" class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">## 440. K-th Smallest in Lexicographical Order</span></div><div class="line">Given integers n <span class="keyword">and</span> k, find <span class="keyword">the</span> lexicographically k-th smallest <span class="keyword">integer</span> <span class="keyword">in</span> <span class="keyword">the</span> range <span class="built_in">from</span> <span class="number">1</span> <span class="built_in">to</span> n.</div><div class="line"></div><div class="line">Note: <span class="number">1</span> ≤ k ≤ n ≤ <span class="number">109.</span></div><div class="line"></div><div class="line">Example:</div></pre></td></tr></table></len(e);i++{></p>
<p>Input:<br>n: 13   k: 2</p>
<p>Output:<br>10</p>
<p>Explanation:<br>The lexicographical order is [1, 10, 11, 12, 13, 2, 3, 4, 5, 6, 7, 8, 9], so the second smallest number is 10.<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">求字典序的题。和头条的校招面试题一模一样。</div></pre></td></tr></table></figure></p>
<p>var Len,n,m,ret int<br>var num,ans [20]int</p>
<p>func valueOfBegin(b int ) int{<br>    cnt :=0<br>    for i:=b;i&lt;=Len;i++{<br>        cnt = cnt <em>10 + num[Len-i+1]<br>    }<br>    return cnt<br>}<br>func countofNum(a [20]int,anslen int) int{<br>    k,cnt :=1,0<br>    for i:=0;i+anslen &lt;Len;i++{<br>        cnt +=k<br>        k</em>=10<br>    }<br>    op :=0<br>    for i:=1;i&lt;=anslen;i++{<br>        id := Len-i+1<br>        if num[id]&gt;a[i]{<br>            op = -1<br>            break<br>        }else if num[id] &lt; a[i]{<br>            op = 1<br>            break<br>        }<br>    }<br>    if op == 0{<br>        if anslen == Len{<br>            return 1<br>        }<br>        return valueOfBegin(anslen+1)+1+cnt<br>    }<br>    if op == 1{<br>        return cnt<br>    }<br>        k = 1<br>        for i:=0;i&lt;Len-anslen;i++{<br>            k*=10</p>
<pre><code>}
return cnt +k
</code></pre><p>}</p>
<p>func dfs(ans [20]int, cur,m int){<br>    if m == 1{<br>        ret = 0<br>        for i:=1;i&lt;=cur;i++{<br>            ret = ret *10 + ans[i]<br>        }<br>        return<br>    }<br>    m –<br>    for i:=0;i&lt;=9;i++{<br>        ans[cur+1] = i<br>        cnt := countofNum(ans,cur+1)<br>        if cnt &gt;=m{<br>            dfs(ans,cur+1,m)<br>            return<br>        }else{<br>            m -= cnt<br>        }<br>    }<br>}</p>
<p>func findKthNumber(a int, k int) int {<br>    Len = 0<br>    n = a<br>    m = k<br>    for n&gt;0{<br>        Len ++<br>        num[Len] = n%10<br>        n/=10<br>    }<br>    for i:=1;i&lt;=9;i++{<br>        ans[1] = i<br>        cnt := countofNum(ans,1)<br>        if cnt &gt;=m{<br>            dfs(ans,1,m)<br>            break<br>        }else{<br>            m -= cnt<br>        }<br>    }<br>    return ret<br>}<br>```</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">Leetcode</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">Golang</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/leetcode_weekly_contest10.html">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-dpdk_pcap" class="article article-type-post  article-index" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/dpdk_pcap.html">手写一个Pcap捕包工具及性能优化</a>
    </h1>
  

        
        <a href="/dpdk_pcap.html" class="archive-article-date">
  	<time datetime="2016-10-19T04:37:31.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-10-19</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这是在项目上遇到的问题。因为项目的缘故，需要实现pcap捕包的功能，在使用后发现libpcap自身API使用比较复杂，就手写了一个API并尝试进行性能优化。部分代码在githuab上。<a href="https://github.com/NachtZ/pcapDumper" rel="external nofollow noopener noreferrer" target="_blank">pcapDumper</a></p>
<h2 id="pcap文件格式"><a href="#pcap文件格式" class="headerlink" title="pcap文件格式"></a>pcap文件格式</h2><p>一个pcap文件的结构如下：<br><img src="http://hi.csdn.net/attachment/201003/27/4633639_1269693284d53M.png" alt="pic">(图片来自<a href="http://www.cnblogs.com/caoguoping100/p/3658792.html" rel="external nofollow noopener noreferrer" target="_blank">博客</a>)</p>
<p>如上图，一个pcap文件，有两个部分组成，一个Pcap 头部，和一堆包。其中每一个包都有两个字段，分别是Packet Head和 Packet Data。它们的数据结构如下：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> _pcap_file_header &#123;</div><div class="line">	<span class="keyword">uint32_t</span> magic;</div><div class="line">	<span class="keyword">uint16_t</span> version_major;</div><div class="line">	<span class="keyword">uint16_t</span> version_minor;</div><div class="line">	<span class="keyword">int32_t</span> thiszone;     <span class="comment">/* gmt to local correction */</span></div><div class="line">	<span class="keyword">uint32_t</span> sigfigs;    <span class="comment">/* accuracy of timestamps */</span></div><div class="line">	<span class="keyword">uint32_t</span> snaplen;    <span class="comment">/* max length saved portion of each pkt */</span></div><div class="line">	<span class="keyword">uint32_t</span> linktype;   <span class="comment">/* data link type (LINKTYPE_*) */</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> _pcap_pkthdr &#123;</div><div class="line">	<span class="keyword">struct</span> _timeval ts;      <span class="comment">/* time stamp using 32 bits fields */</span></div><div class="line">	<span class="keyword">uint32_t</span> caplen;     <span class="comment">/* length of portion present */</span></div><div class="line">	<span class="keyword">uint32_t</span> len;        <span class="comment">/* length this packet (off wire) */</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><code>pcap_file_header</code>存储着包结构的头，<code>magic</code>字段是字节顺序。<code>version_major</code> <code>version_minor</code>分别是主版本号和次版本号。 <code>thiszone</code>代表时区， <code>snaplen</code>是数据包的最大长度，一般设置为65535. <code>linktype</code>表示链路类型。<br>可以看到<code>pcap_file_header</code>存储的是，录制这个包的时候的网络状态。</p>
<p><code>pcap_pkthdr</code> 储存的是数据包的结构。包括数据包的时间戳和包长。在这个结构之后，紧跟着就是一段长为<code>len</code>的数据字段，表示的是这个pkthdr所指的数据包，是二层数据包结构。这个<code>len</code>同时也指向了下一个数据包的位置，即偏移到<code>len+1</code>的位置。</p>
<p>在写入的时候，就是按照上图所示，一个<code>pcap_file_hdr</code>,然后<code>pcap_pkthdr1</code>,<code>pkt_data1</code>,<code>pcap_pkthdr2</code>,<code>pkt_data2</code>,这么写入的。<br><figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">pcap_file_hdr</span>-&gt;</span><span class="function"><span class="title">pcap_pkthdr</span>-&gt;</span><span class="function"><span class="title">pkt_data</span>-&gt;</span><span class="function"><span class="title">pcap_pkthdr</span>-&gt;</span><span class="function"><span class="title">pkt_data</span>-&gt;</span><span class="function"><span class="title">pcap_pkthdr</span>-&gt;</span><span class="function"><span class="title">pkt_data</span>-&gt;</span><span class="function"><span class="title">pcap_pkthdr</span>-&gt;</span><span class="function"><span class="title">pkt_data</span>-&gt;</span>...</div></pre></td></tr></table></figure></p>
<p>所以在读取pcap文件的时候，实际上是线性的访问数据包的。只有读取了第n个数据包，你才能访问的到底n+1个数据包。</p>
<h2 id="注意的坑"><a href="#注意的坑" class="headerlink" title="注意的坑"></a>注意的坑</h2><p><code>pcap_pkthdr</code>中的<code>timeval</code>是32位。它的实际结构应该是这样的：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> _timeval &#123;</div><div class="line">        <span class="keyword">uint32_t</span> tv_sec;     <span class="comment">/* seconds */</span></div><div class="line">        <span class="keyword">uint32_t</span> tv_usec;    <span class="comment">/* microseconds */</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>在64位系统中，<code>timeval</code>中两个字段都是<code>uint64_t</code>的值。所以如果没有注意到这一点，会出现字段错误。导致保存的pcap包无法被wireshark等工具正常识别。</p>
<h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><p>在性能上，主要的瓶颈在于写入硬盘。如果程序在每次拿到一个包就写入到硬盘中，就会造成频繁的小文件的写入。这样发挥不了硬盘的最大速度。可以使用一个内存buf来把数据先缓存在内存中，等到了一定大小（比如16M）或者pcap文件写入完毕后再写入硬盘。</p>
<h2 id="架构上的优化"><a href="#架构上的优化" class="headerlink" title="架构上的优化"></a>架构上的优化</h2><p>程序上的优化最高能够让写包速度达到100Mbps。而相对的，硬盘的最高速度应该是在1000Mbps以上，网卡的性能则可以达到10000Mbps上。所以实际上写包速率是满足不了高性能捕包的写包需求的。这个时候就需要从架构上优化了。</p>
<p>有两种思路可以从架构上优化，第一种是使用多线程<strong>并行</strong>。每个线程都进行<code>捕包-&gt;解析包-&gt;写入包-&gt;再捕包</code>的过程。这个过程能够提升一定的性能。但是会有几个问题：</p>
<ol>
<li>频繁的中断。</li>
<li>资源争用。</li>
</ol>
<p>每个线程在写入一个包的时候，在三个过程，需要申请不同的资源，分别是网卡资源，CPU计算资源和硬盘IO资源。系统的中断和切换资源需要消耗一定的时间。此外，资源争用的问题也会发生，这主要体现在硬盘的资源上。在录制包的场景下，硬盘资源是瓶颈资源。这个时候多个线程在频繁请求硬盘资源，会导致硬盘的写入性能下降。比如我有100的时间片，这100的时间片中，可能只有80的时间片用在了真正的写入硬盘中，其他的时间片都花费在了资源调度上。这会使每个线程的性能不及原来单线程的时候，而且硬盘也无法发挥自己百分百的性能。</p>
<p>另一种是使用多线程<strong>并发</strong>。每个线程都只干一件事情。捕包有捕包的线程，解析包有解析包的线程，写入包有写入包的线程。这样在线程间的资源竞争就能够被避免。在实际的项目中，甚至把写入包之后的内存释放都单独分出一个线程。就是为了让硬盘IO的效率达到最大。实际的效果，能够使程序支持1000Mbps的录包速度。如果需要再提高性能，就可能需要使用SSD，或者分布式存储，磁盘阵列等来解决了。</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Linux</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">DPDK</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">网络</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/dpdk_pcap.html">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 NachtZ
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="external nofollow noopener noreferrer">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="./",n(0)}([function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=/\/|index.html/g;return t.replace(e,"")===n.replace(e,"")}function i(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,e=0,r=t.length;e<r;e++){var i=t[e];o(n,i.getAttribute("href"))&&(0,d.default)(i,"active")}}function u(t){for(var n=t.offsetLeft,e=t.offsetParent;null!==e;)n+=e.offsetLeft,e=e.offsetParent;return n}function f(t){for(var n=t.offsetTop,e=t.offsetParent;null!==e;)n+=e.offsetTop,e=e.offsetParent;return n}function c(t,n,e,r,o){var i=u(t),c=f(t)-n;if(c-e<=o){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,h.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(e||c)+"px",a.style.left=i+"px",a.style.zIndex=r||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");c(t,document.body.scrollTop,-63,2,0),c(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}function l(){x.default.versions.mobile&&window.screen.width<800&&(i(),s())}var p=e(71),d=r(p),v=e(72),y=(r(v),e(84)),h=r(y),b=e(69),x=r(b),g=e(75),m=r(g),w=e(70);l(),(0,w.addLoadEvent)(function(){m.default.init()}),t.exports={}},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){var r=e(49),o=e(15);t.exports=function(t){return r(o(t))}},function(t,n,e){t.exports=!e(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,e){var r=e(6),o=e(12);t.exports=e(4)?function(t,n,e){return r.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(10),o=e(30),i=e(24),u=Object.defineProperty;n.f=e(4)?Object.defineProperty:function(t,n,e){if(r(t),n=i(n,!0),r(e),o)try{return u(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(22)("wks"),o=e(13),i=e(1).Symbol,u="function"==typeof i,f=t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)("Symbol."+t))};f.store=r},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,e){var r=e(35),o=e(16);t.exports=Object.keys||function(t){return r(t,o)}},function(t,n,e){var r=e(11);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,e){var r=e(6).f,o=e(2),i=e(7)("toStringTag");t.exports=function(t,n,e){t&&!o(t=e?t:t.prototype,i)&&r(t,i,{configurable:!0,value:n})}},function(t,n,e){var r=e(22)("keys"),o=e(13);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,n,e){var r=e(1),o="__core-js_shared__",i=r[o]||(r[o]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){var r=e(11);t.exports=function(t,n){if(!r(t))return t;var e,o;if(n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;if("function"==typeof(e=t.valueOf)&&!r(o=e.call(t)))return o;if(!n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,n,e){var r=e(1),o=e(14),i=e(18),u=e(26),f=e(6).f;t.exports=function(t){var n=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in n||f(n,t,{value:u.f(t)})}},function(t,n,e){n.f=e(7)},function(t,n,e){var r=e(1),o=e(14),i=e(46),u=e(5),f="prototype",c=function(t,n,e){var a,s,l,p=t&c.F,d=t&c.G,v=t&c.S,y=t&c.P,h=t&c.B,b=t&c.W,x=d?o:o[n]||(o[n]={}),g=x[f],m=d?r:v?r[n]:(r[n]||{})[f];d&&(e=n);for(a in e)s=!p&&m&&void 0!==m[a],s&&a in x||(l=s?m[a]:e[a],x[a]=d&&"function"!=typeof m[a]?e[a]:h&&s?i(l,r):b&&m[a]==l?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n[f]=t[f],n}(l):y&&"function"==typeof l?i(Function.call,l):l,y&&((x.virtual||(x.virtual={}))[a]=l,t&c.R&&g&&!g[a]&&u(g,a,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n,e){var r=e(11),o=e(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,n,e){t.exports=!e(4)&&!e(8)(function(){return 7!=Object.defineProperty(e(29)("div"),"a",{get:function(){return 7}}).a})},function(t,n,e){"use strict";var r=e(18),o=e(27),i=e(36),u=e(5),f=e(2),c=e(17),a=e(51),s=e(20),l=e(58),p=e(7)("iterator"),d=!([].keys&&"next"in[].keys()),v="@@iterator",y="keys",h="values",b=function(){return this};t.exports=function(t,n,e,x,g,m,w){a(e,n,x);var O,S,_,j=function(t){if(!d&&t in A)return A[t];switch(t){case y:return function(){return new e(this,t)};case h:return function(){return new e(this,t)}}return function(){return new e(this,t)}},P=n+" Iterator",E=g==h,M=!1,A=t.prototype,T=A[p]||A[v]||g&&A[g],L=T||j(g),N=g?E?j("entries"):L:void 0,C="Array"==n?A.entries||T:T;if(C&&(_=l(C.call(new t)),_!==Object.prototype&&(s(_,P,!0),r||f(_,p)||u(_,p,b))),E&&T&&T.name!==h&&(M=!0,L=function(){return T.call(this)}),r&&!w||!d&&!M&&A[p]||u(A,p,L),c[n]=L,c[P]=b,g)if(O={values:E?L:j(h),keys:m?L:j(y),entries:N},w)for(S in O)S in A||i(A,S,O[S]);else o(o.P+o.F*(d||M),n,O);return O}},function(t,n,e){var r=e(10),o=e(55),i=e(16),u=e(21)("IE_PROTO"),f=function(){},c="prototype",a=function(){var t,n=e(29)("iframe"),r=i.length,o="<",u=">";for(n.style.display="none",e(48).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write(o+"script"+u+"document.F=Object"+o+"/script"+u),t.close(),a=t.F;r--;)delete a[c][i[r]];return a()};t.exports=Object.create||function(t,n){var e;return null!==t?(f[c]=r(t),e=new f,f[c]=null,e[u]=t):e=a(),void 0===n?e:o(e,n)}},function(t,n,e){var r=e(35),o=e(16).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,e){var r=e(2),o=e(3),i=e(45)(!1),u=e(21)("IE_PROTO");t.exports=function(t,n){var e,f=o(t),c=0,a=[];for(e in f)e!=u&&r(f,e)&&a.push(e);for(;n.length>c;)r(f,e=n[c++])&&(~i(a,e)||a.push(e));return a}},function(t,n,e){t.exports=e(5)},function(t,n,e){var r=e(15);t.exports=function(t){return Object(r(t))}},function(t,n,e){t.exports={default:e(41),__esModule:!0}},function(t,n,e){t.exports={default:e(42),__esModule:!0}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var o=e(39),i=r(o),u=e(38),f=r(u),c="function"==typeof f.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":typeof t};n.default="function"==typeof f.default&&"symbol"===c(i.default)?function(t){return"undefined"==typeof t?"undefined":c(t)}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":"undefined"==typeof t?"undefined":c(t)}},function(t,n,e){e(65),e(63),e(66),e(67),t.exports=e(14).Symbol},function(t,n,e){e(64),e(68),t.exports=e(26).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,e){var r=e(3),o=e(61),i=e(60);t.exports=function(t){return function(n,e,u){var f,c=r(n),a=o(c.length),s=i(u,a);if(t&&e!=e){for(;a>s;)if(f=c[s++],f!=f)return!0}else for(;a>s;s++)if((t||s in c)&&c[s]===e)return t||s||0;return!t&&-1}}},function(t,n,e){var r=e(43);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},function(t,n,e){var r=e(9),o=e(34),i=e(19);t.exports=function(t){var n=r(t),e=o.f;if(e)for(var u,f=e(t),c=i.f,a=0;f.length>a;)c.call(t,u=f[a++])&&n.push(u);return n}},function(t,n,e){t.exports=e(1).document&&document.documentElement},function(t,n,e){var r=e(28);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n,e){var r=e(28);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,n,e){"use strict";var r=e(32),o=e(12),i=e(20),u={};e(5)(u,e(7)("iterator"),function(){return this}),t.exports=function(t,n,e){t.prototype=r(u,{next:o(1,e)}),i(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,e){var r=e(9),o=e(3);t.exports=function(t,n){for(var e,i=o(t),u=r(i),f=u.length,c=0;f>c;)if(i[e=u[c++]]===n)return e}},function(t,n,e){var r=e(13)("meta"),o=e(11),i=e(2),u=e(6).f,f=0,c=Object.isExtensible||function(){return!0},a=!e(8)(function(){return c(Object.preventExtensions({}))}),s=function(t){u(t,r,{value:{i:"O"+ ++f,w:{}}})},l=function(t,n){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!c(t))return"F";if(!n)return"E";s(t)}return t[r].i},p=function(t,n){if(!i(t,r)){if(!c(t))return!0;if(!n)return!1;s(t)}return t[r].w},d=function(t){return a&&v.NEED&&c(t)&&!i(t,r)&&s(t),t},v=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:d}},function(t,n,e){var r=e(6),o=e(10),i=e(9);t.exports=e(4)?Object.defineProperties:function(t,n){o(t);for(var e,u=i(n),f=u.length,c=0;f>c;)r.f(t,e=u[c++],n[e]);return t}},function(t,n,e){var r=e(19),o=e(12),i=e(3),u=e(24),f=e(2),c=e(30),a=Object.getOwnPropertyDescriptor;n.f=e(4)?a:function(t,n){if(t=i(t),n=u(n,!0),c)try{return a(t,n)}catch(t){}if(f(t,n))return o(!r.f.call(t,n),t[n])}},function(t,n,e){var r=e(3),o=e(33).f,i={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(t){try{return o(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==i.call(t)?f(t):o(r(t))}},function(t,n,e){var r=e(2),o=e(37),i=e(21)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,e){var r=e(23),o=e(15);t.exports=function(t){return function(n,e){var i,u,f=String(o(n)),c=r(e),a=f.length;return c<0||c>=a?t?"":void 0:(i=f.charCodeAt(c),i<55296||i>56319||c+1===a||(u=f.charCodeAt(c+1))<56320||u>57343?t?f.charAt(c):i:t?f.slice(c,c+2):(i-55296<<10)+(u-56320)+65536)}}},function(t,n,e){var r=e(23),o=Math.max,i=Math.min;t.exports=function(t,n){return t=r(t),t<0?o(t+n,0):i(t,n)}},function(t,n,e){var r=e(23),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,n,e){"use strict";var r=e(44),o=e(52),i=e(17),u=e(3);t.exports=e(31)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,o(1)):"keys"==n?o(0,e):"values"==n?o(0,t[e]):o(0,[e,t[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,n){},function(t,n,e){"use strict";var r=e(59)(!0);e(31)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=r(n,e),this._i+=t.length,{value:t,done:!1})})},function(t,n,e){"use strict";var r=e(1),o=e(2),i=e(4),u=e(27),f=e(36),c=e(54).KEY,a=e(8),s=e(22),l=e(20),p=e(13),d=e(7),v=e(26),y=e(25),h=e(53),b=e(47),x=e(50),g=e(10),m=e(3),w=e(24),O=e(12),S=e(32),_=e(57),j=e(56),P=e(6),E=e(9),M=j.f,A=P.f,T=_.f,L=r.Symbol,N=r.JSON,C=N&&N.stringify,k="prototype",F=d("_hidden"),q=d("toPrimitive"),I={}.propertyIsEnumerable,B=s("symbol-registry"),D=s("symbols"),W=s("op-symbols"),H=Object[k],K="function"==typeof L,R=r.QObject,J=!R||!R[k]||!R[k].findChild,U=i&&a(function(){return 7!=S(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,n,e){var r=M(H,n);r&&delete H[n],A(t,n,e),r&&t!==H&&A(H,n,r)}:A,G=function(t){var n=D[t]=S(L[k]);return n._k=t,n},$=K&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},z=function(t,n,e){return t===H&&z(W,n,e),g(t),n=w(n,!0),g(e),o(D,n)?(e.enumerable?(o(t,F)&&t[F][n]&&(t[F][n]=!1),e=S(e,{enumerable:O(0,!1)})):(o(t,F)||A(t,F,O(1,{})),t[F][n]=!0),U(t,n,e)):A(t,n,e)},Y=function(t,n){g(t);for(var e,r=b(n=m(n)),o=0,i=r.length;i>o;)z(t,e=r[o++],n[e]);return t},Q=function(t,n){return void 0===n?S(t):Y(S(t),n)},X=function(t){var n=I.call(this,t=w(t,!0));return!(this===H&&o(D,t)&&!o(W,t))&&(!(n||!o(this,t)||!o(D,t)||o(this,F)&&this[F][t])||n)},V=function(t,n){if(t=m(t),n=w(n,!0),t!==H||!o(D,n)||o(W,n)){var e=M(t,n);return!e||!o(D,n)||o(t,F)&&t[F][n]||(e.enumerable=!0),e}},Z=function(t){for(var n,e=T(m(t)),r=[],i=0;e.length>i;)o(D,n=e[i++])||n==F||n==c||r.push(n);return r},tt=function(t){for(var n,e=t===H,r=T(e?W:m(t)),i=[],u=0;r.length>u;)!o(D,n=r[u++])||e&&!o(H,n)||i.push(D[n]);return i};K||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),n=function(e){this===H&&n.call(W,e),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),U(this,t,O(1,e))};return i&&J&&U(H,t,{configurable:!0,set:n}),G(t)},f(L[k],"toString",function(){return this._k}),j.f=V,P.f=z,e(33).f=_.f=Z,e(19).f=X,e(34).f=tt,i&&!e(18)&&f(H,"propertyIsEnumerable",X,!0),v.f=function(t){return G(d(t))}),u(u.G+u.W+u.F*!K,{Symbol:L});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;nt.length>et;)d(nt[et++]);for(var nt=E(d.store),et=0;nt.length>et;)y(nt[et++]);u(u.S+u.F*!K,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=L(t)},keyFor:function(t){if($(t))return h(B,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){J=!0},useSimple:function(){J=!1}}),u(u.S+u.F*!K,"Object",{create:Q,defineProperty:z,defineProperties:Y,getOwnPropertyDescriptor:V,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),N&&u(u.S+u.F*(!K||a(function(){var t=L();return"[null]"!=C([t])||"{}"!=C({a:t})||"{}"!=C(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!$(t)){for(var n,e,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);return n=r[1],"function"==typeof n&&(e=n),!e&&x(n)||(n=function(t,n){if(e&&(n=e.call(this,t,n)),!$(n))return n}),r[1]=n,C.apply(N,r)}}}),L[k][q]||e(5)(L[k],q,L[k].valueOf),l(L,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,n,e){e(25)("asyncIterator")},function(t,n,e){e(25)("observable")},function(t,n,e){e(62);for(var r=e(1),o=e(5),i=e(17),u=e(7)("toStringTag"),f=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],c=0;c<5;c++){var a=f[c],s=r[a],l=s&&s.prototype;l&&!l[u]&&o(l,u,a),i[a]=i.Array}},function(t,n){"use strict";var e={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&t.indexOf("KHTML")==-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:t.indexOf("Safari")==-1,weixin:t.indexOf("MicroMessenger")==-1}}()};t.exports=e},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=e(40),i=r(o),u=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):o[t]||t}function n(t){return l[t]}var e=/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,r=/['<> "&]/g,o={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},f=/\u00a0/g,c=/<br\s*\/?>/gi,a=/\r?\n/g,s=/\s/g,l={};for(var p in o)l[o[p]]=p;return o["&apos;"]="'",l["'"]="&#39;",{encode:function(t){return t?(""+t).replace(r,n).replace(a,"<br/>").replace(s,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(c,"\n").replace(e,t).replace(f," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e+=2)n.push(String.fromCharCode("0x"+t.slice(e,e+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,e=t.length;e>n;n++)t[n]=u.encodeObject(t[n]);else if("object"==("undefined"==typeof t?"undefined":(0,i.default)(t)))for(var r in t)t[r]=u.encodeObject(t[r]);else if("string"==typeof t)return u.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=u},function(t,n){function e(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=e},function(t,n){function e(t,n){if(t.classList)t.classList.remove(n);else{var e=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(e," ")}}t.exports=e},,,function(t,n){"use strict";function e(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){var n=document.querySelectorAll(".article-entry a:not(.article-more-a)");n.forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}var e=document.querySelector("#js-aboutme");e&&0!==e.length&&(e.innerHTML=e.innerText)}t.exports={init:e}},,,,,,,,,function(t,n){function e(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var e=t.nextSibling;return e?t.parentNode.insertBefore(n,e):t.parentNode.appendChild(n)}t.exports=e}])</script><script src="/./main.f6a68c.js"></script><script>!function(){var e=function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)};e("/slider.885efe.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友链</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">SDN</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Linux</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Shell</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Leetcode</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Golang</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Algorithm</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">DPDK</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Snort</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Docker</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">网络</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Resume</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">面经</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br>1、请确保node版本大于6.2<br>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br> npm i hexo-generator-json-content --save<br><br>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title" rel="external nofollow noopener noreferrer"><i class="icon-quo-left icon"></i>友情链接1</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title" rel="external nofollow noopener noreferrer"><i class="icon-quo-left icon"></i>友情链接2</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title" rel="external nofollow noopener noreferrer"><i class="icon-quo-left icon"></i>友情链接3</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title" rel="external nofollow noopener noreferrer"><i class="icon-quo-left icon"></i>友情链接4</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title" rel="external nofollow noopener noreferrer"><i class="icon-quo-left icon"></i>友情链接5</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title" rel="external nofollow noopener noreferrer"><i class="icon-quo-left icon"></i>友情链接6</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">闷声&lt;br&gt;发大财&lt;br&gt;最上川</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
